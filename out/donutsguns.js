/*! For license information please see donutsguns.js.LICENSE.txt */
(()=>{"use strict";var t={"./src/guns/AssaultRifle.ts":(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(){var t=ModAPI.reflect.getClassByName("DamageSource"),e=ModAPI.reflect.getClassById("net.minecraft.creativetab.CreativeTabs").staticVariables.tabMisc,n=ModAPI.reflect.getClassById("net.minecraft.item.Item"),i=ModAPI.reflect.getSuper(n,(function(t){return 1===t.length})),r=function(){i(this),this.$setCreativeTab(e)};ModAPI.reflect.prototypeStack(n,r);var o=!1;function a(){var t=(new r).$setUnlocalizedName(ModAPI.util.str("assaultrifle")).$setMaxStackSize(1);return n.staticMethods.registerItem.method(ModAPI.keygen.item("assaultrifle"),ModAPI.util.str("assaultrifle"),t),ModAPI.items.assaultrifle=t,t}if(r.prototype.$onPlayerStoppedUsing=function(t){o=!1},r.prototype.$onItemUseFinish=function(t){return t},r.prototype.$getMaxItemUseDuration=function(t){return 72e3},r.prototype.$getItemUseAction=function(t){return ModAPI.reflect.getClassByName("EnumAction").staticVariables.DRINK},r.prototype.$onItemRightClick=function(e,n,i){if(!o){o=!0;var a=t.staticVariables.cactus,s=ModAPI.util.wrap(n),c=ModAPI.util.wrap(i),l=function(t,e){for(var n=t.getPositionEyes(0),i=t.rayTrace(32,0).hitVec,r=e.getEntitiesWithinAABBExcludingEntity(t.getRef(),t.getEntityBoundingBox().expand(32,32,32).getRef()).getCorrective().array,o=null,a=!1,s=0,c=32,l=ModAPI.reflect.getClassByName("EnumParticleTypes").staticVariables.SMOKE_NORMAL,u=t.posX,d=t.posY+1.5,f=t.posZ,A=i.xCoord-u,p=i.yCoord-d,y=i.zCoord-f,g=Math.sqrt(A*A+p*p+y*y),I=A/g,m=p/g,h=y/g,M=g/50,P=0;P<=50;P++){var v=u+I*P*M,E=d+m*P*M,b=f+h*P*M;e.spawnParticle(l,v,E,b,0,0,0,[0])}for(P=0;P<r.length;P++)if(r[P]){var S=r[P],R=S.getEntityBoundingBox().expand(.3,.3,.3).calculateIntercept(n.getRef(),i.getRef());if(null!=R){var k=n.distanceTo(R.hitVec.getRef());k<c&&(c=k,o=S,(a=S.getPositionEyes(0).distanceTo(R.hitVec.getRef())<.72)&&(s=1))}}return null!=o?{entity:o,headshot:a,intheadshot:s}:null}(c,s);c.setItemInUse(e,r.prototype.$getMaxItemUseDuration(e)),null!=l?s.isRemote||(l.entity.attackEntityFrom(a,10+16*l.intheadshot),l.headshot&&console.log("H E A D S H O T"),s.playSoundAtEntity(c.getRef(),ModAPI.util.str("tile.piston.out"),1,1.8)):s.isRemote||s.playSoundAtEntity(c.getRef(),ModAPI.util.str("random.click"),1,1.8)}return e},ModAPI.items)return a();ModAPI.addEventListener("bootstrap",a)}},"./src/guns/Pistol.ts":(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(){var t=ModAPI.reflect.getClassByName("DamageSource"),e=ModAPI.reflect.getClassById("net.minecraft.creativetab.CreativeTabs").staticVariables.tabMisc,n=ModAPI.reflect.getClassById("net.minecraft.item.Item"),i=ModAPI.reflect.getSuper(n,(function(t){return 1===t.length})),r=function(){i(this),this.$setCreativeTab(e)};function o(){var t=(new r).$setUnlocalizedName(ModAPI.util.str("pistol")).$setMaxStackSize(1);return n.staticMethods.registerItem.method(ModAPI.keygen.item("pistol"),ModAPI.util.str("pistol"),t),ModAPI.items.pistol=t,t}if(ModAPI.reflect.prototypeStack(n,r),r.prototype.$onItemRightClick=function(e,n,i){var r=t.staticVariables.cactus,o=ModAPI.util.wrap(n),a=ModAPI.util.wrap(i),s=function(t,e){for(var n=t.getPositionEyes(0),i=t.rayTrace(16,0).hitVec,r=e.getEntitiesWithinAABBExcludingEntity(t.getRef(),t.getEntityBoundingBox().expand(16,16,16).getRef()).getCorrective().array,o=null,a=!1,s=0,c=16,l=0;l<r.length;l++)if(r[l]){var u=r[l],d=u.getEntityBoundingBox().expand(.3,.3,.3).calculateIntercept(n.getRef(),i.getRef());if(null!=d){var f=n.distanceTo(d.hitVec.getRef());f<c&&(c=f,o=u,(a=u.getPositionEyes(0).distanceTo(d.hitVec.getRef())<.72)&&(s=1))}}return null!=o?{entity:o,headshot:a,intheadshot:s}:null}(a,o);return null!=s?o.isRemote||(s.entity.attackEntityFrom(r,10+16*s.intheadshot),s.headshot&&console.log("H E A D S H O T"),o.playSoundAtEntity(a.getRef(),ModAPI.util.str("tile.piston.out"),1,1.8)):o.isRemote||o.playSoundAtEntity(a.getRef(),ModAPI.util.str("random.click"),1,1.8),e},ModAPI.items)return o();ModAPI.addEventListener("bootstrap",o)}},"./src/main.ts":function(t,e,n){var i=this&&this.__awaiter||function(t,e,n,i){return new(n||(n=Promise))((function(r,o){function a(t){try{c(i.next(t))}catch(t){o(t)}}function s(t){try{c(i.throw(t))}catch(t){o(t)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}c((i=i.apply(t,e||[])).next())}))},r=this&&this.__generator||function(t,e){var n,i,r,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(o=0)),o;)try{if(n=1,i&&(r=2&s[0]?i.return:s[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,s[1])).done)return r;switch(i=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,i=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!((r=(r=o.trys).length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){o.label=s[1];break}if(6===s[0]&&o.label<r[1]){o.label=r[1],r=s;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(s);break}r[2]&&o.ops.pop(),o.trys.pop();continue}s=e.call(t,o)}catch(t){s=[6,t],i=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}};Object.defineProperty(e,"__esModule",{value:!0});var o=n("./src/guns/Pistol.ts"),a=n("./src/guns/AssaultRifle.ts"),s="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAADySURBVFhH7ZQxDoMwDEVNr4G6VmJC6mk4Itdh7VpxjsBPDaKVCLZxypInIccg5zs/CVQoKAj8uHLjeETouo6HvlQcU3yJ932PIKkTceRAFH8NA6dE3IzbVogdQBOPtuVXfk5IJ8jWhKY4SxPaQvcmLEWuTUj/A1sqiEEcTQBENDWjvh3mvZtxccLiwMqvE0DrhNUBCCy1KSdAUsPiwFYcpM5ENrYWh3tdI4cT4dk0MSKPXzMSRSC+PMi14mcO4e7esv2iJqyHEGDVPCR6jyMC5luERXOfuoY7QFi8MKsDe6tXk8OBv7Ge/E96DZeKFwoOEE1wUX7TFh5zsgAAAABJRU5ErkJggg==";ModAPI.meta.title("Donut's Gun Mod"),ModAPI.meta.version("wIP"),ModAPI.meta.icon(s),ModAPI.meta.description("Requires AsyncSink. So far just skidded code from radman"),ModAPI.dedicatedServer.appendCode(o.default),ModAPI.dedicatedServer.appendCode(a.default);var c=(0,o.default)(),l=(0,a.default)();ModAPI.addEventListener("lib:asyncsink",(function(){return i(void 0,void 0,void 0,(function(){var t,e,n;return r(this,(function(i){switch(i.label){case 0:return ModAPI.addEventListener("custom:asyncsink_reloaded",(function(){ModAPI.mc.renderItem.registerItem(c,ModAPI.util.str("pistol")),ModAPI.mc.renderItem.registerItem(l,ModAPI.util.str("assaultrifle"))})),AsyncSink.L10N.set("item.pistol.name","Pistol"),AsyncSink.L10N.set("item.assaultrifle.name","Assault Rifle"),AsyncSink.setFile("resourcepacks/AsyncSinkLib/assets/minecraft/models/item/pistol.json",JSON.stringify({parent:"builtin/generated",textures:{layer0:"items/pistol"},display:{thirdperson:{rotation:[5,80,-45],translation:[0,1,-3],scale:[1,1,1]},firstperson:{rotation:[0,-135,25],translation:[0,4,2],scale:[1.8,1.8,1.8]}}})),e=(t=AsyncSink).setFile,n=["resourcepacks/AsyncSinkLib/assets/minecraft/textures/items/pistol.png"],[4,fetch(s)];case 1:return[4,i.sent().arrayBuffer()];case 2:return e.apply(t,n.concat([i.sent()])),[2]}}))}))}))}},e={};!function n(i){var r=e[i];if(void 0!==r)return r.exports;var o=e[i]={exports:{}};return t[i].call(o.exports,o,o.exports,n),o.exports}("./src/main.ts")})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Li9zcmMvZ3Vucy9Bc3NhdWx0UmlmbGUudHMiLCJ3ZWJwYWNrOi8vZG9udXRzZ3Vucy8uL3NyYy9ndW5zL1Bpc3RvbC50cyIsIndlYnBhY2s6Ly9kb251dHNndW5zLy4vc3JjL21haW4udHMiLCJ3ZWJwYWNrOi8vZG9udXRzZ3Vucy93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly9kb251dHNndW5zL3dlYnBhY2svc3RhcnR1cCJdLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbmV4cG9ydHMuZGVmYXVsdCA9IEFzc2F1bHRSaWZsZTtcbmZ1bmN0aW9uIEFzc2F1bHRSaWZsZSgpIHtcbiAgICB2YXIgRGFtYWdlU291cmNlQ2xhc3MgPSBNb2RBUEkucmVmbGVjdC5nZXRDbGFzc0J5TmFtZShcIkRhbWFnZVNvdXJjZVwiKTtcbiAgICB2YXIgY3JlYXRpdmVNaXNjVGFiID0gTW9kQVBJLnJlZmxlY3QuZ2V0Q2xhc3NCeUlkKFwibmV0Lm1pbmVjcmFmdC5jcmVhdGl2ZXRhYi5DcmVhdGl2ZVRhYnNcIikuc3RhdGljVmFyaWFibGVzLnRhYk1pc2M7XG4gICAgdmFyIGl0ZW1DbGFzcyA9IE1vZEFQSS5yZWZsZWN0LmdldENsYXNzQnlJZChcIm5ldC5taW5lY3JhZnQuaXRlbS5JdGVtXCIpO1xuICAgIHZhciBpdGVtU3VwZXIgPSBNb2RBUEkucmVmbGVjdC5nZXRTdXBlcihpdGVtQ2xhc3MsIGZ1bmN0aW9uICh4KSB7IHJldHVybiB4Lmxlbmd0aCA9PT0gMTsgfSk7XG4gICAgdmFyIHJlY29pbEZvcmNlID0gMTA7XG4gICAgdmFyIHJlY29pbFJlY292ZXJ5ID0gMC41O1xuICAgIHZhciByZWNvaWxUaW1lVXAgPSA1MDtcbiAgICB2YXIgbm1pX0Fzc2F1bHRSaWZsZSA9IGZ1bmN0aW9uIG5taV9Bc3NhdWx0UmlmbGUoKSB7XG4gICAgICAgIGl0ZW1TdXBlcih0aGlzKTsgLy9Vc2Ugc3VwZXIgZnVuY3Rpb24gdG8gZ2V0IGJsb2NrIHByb3BlcnRpZXMgb24gdGhpcyBjbGFzcy5cbiAgICAgICAgdGhpcy4kc2V0Q3JlYXRpdmVUYWIoY3JlYXRpdmVNaXNjVGFiKTtcbiAgICB9O1xuICAgIGZ1bmN0aW9uIGVudGl0eVJheUNhc3QocGxheWVyLCB3b3JsZCwgcmFuZ2UpIHtcbiAgICAgICAgdmFyIEhFQURTSE9UX01BWF9ESVNUQU5DRV9GUk9NX0hFQUQgPSAwLjcyO1xuICAgICAgICB2YXIgZXllUG9zaXRpb24gPSBwbGF5ZXIuZ2V0UG9zaXRpb25FeWVzKDAuMCk7XG4gICAgICAgIHZhciB0YXJnZXRQb3NpdGlvbiA9IHBsYXllci5yYXlUcmFjZShyYW5nZSwgMCkuaGl0VmVjO1xuICAgICAgICB2YXIgZW50aXRpZXMgPSB3b3JsZC5nZXRFbnRpdGllc1dpdGhpbkFBQkJFeGNsdWRpbmdFbnRpdHkocGxheWVyLmdldFJlZigpLCBwbGF5ZXIuZ2V0RW50aXR5Qm91bmRpbmdCb3goKS5leHBhbmQocmFuZ2UsIHJhbmdlLCByYW5nZSkuZ2V0UmVmKCkpLmdldENvcnJlY3RpdmUoKS5hcnJheTtcbiAgICAgICAgdmFyIGNsb3Nlc3RFbnRpdHkgPSBudWxsO1xuICAgICAgICB2YXIgaXNIZWFkc2hvdCA9IGZhbHNlO1xuICAgICAgICB2YXIgaXNIZWFkc2hvdEludCA9IDA7XG4gICAgICAgIHZhciBjbG9zZXN0RGlzdGFuY2UgPSByYW5nZTtcbiAgICAgICAgLy8gUGFydGljbGUgaGFuZGxlclxuICAgICAgICB2YXIgZW51bVBhcnRpY2xlU21va2UgPSBNb2RBUEkucmVmbGVjdC5nZXRDbGFzc0J5TmFtZShcIkVudW1QYXJ0aWNsZVR5cGVzXCIpLnN0YXRpY1ZhcmlhYmxlcy5TTU9LRV9OT1JNQUw7XG4gICAgICAgIHZhciBleWVNb2QgPSAxLjU7XG4gICAgICAgIC8vIFBsYXllciBwb3NpdGlvblxuICAgICAgICB2YXIgcGxheWVyWCA9IHBsYXllci5wb3NYO1xuICAgICAgICB2YXIgcGxheWVyWSA9IHBsYXllci5wb3NZICsgZXllTW9kO1xuICAgICAgICB2YXIgcGxheWVyWiA9IHBsYXllci5wb3NaO1xuICAgICAgICAvLyBUYXJnZXQgcG9zaXRpb25cbiAgICAgICAgdmFyIHRhcmdldFggPSB0YXJnZXRQb3NpdGlvbi54Q29vcmQ7XG4gICAgICAgIHZhciB0YXJnZXRZID0gdGFyZ2V0UG9zaXRpb24ueUNvb3JkO1xuICAgICAgICB2YXIgdGFyZ2V0WiA9IHRhcmdldFBvc2l0aW9uLnpDb29yZDtcbiAgICAgICAgLy8gQ2FsY3VsYXRlIGRpcmVjdGlvbiB2ZWN0b3JcbiAgICAgICAgdmFyIGRpclggPSB0YXJnZXRYIC0gcGxheWVyWDtcbiAgICAgICAgdmFyIGRpclkgPSB0YXJnZXRZIC0gcGxheWVyWTtcbiAgICAgICAgdmFyIGRpclogPSB0YXJnZXRaIC0gcGxheWVyWjtcbiAgICAgICAgLy8gQ2FsY3VsYXRlIHRoZSBkaXN0YW5jZSBiZXR3ZWVuIHRoZSBwbGF5ZXIgYW5kIHRoZSB0YXJnZXRcbiAgICAgICAgdmFyIGRpc3RhbmNlID0gTWF0aC5zcXJ0KGRpclggKiBkaXJYICsgZGlyWSAqIGRpclkgKyBkaXJaICogZGlyWik7XG4gICAgICAgIC8vIE5vcm1hbGl6ZSB0aGUgZGlyZWN0aW9uIHZlY3RvclxuICAgICAgICB2YXIgc3RlcFggPSBkaXJYIC8gZGlzdGFuY2U7XG4gICAgICAgIHZhciBzdGVwWSA9IGRpclkgLyBkaXN0YW5jZTtcbiAgICAgICAgdmFyIHN0ZXBaID0gZGlyWiAvIGRpc3RhbmNlO1xuICAgICAgICAvLyBEZWZpbmUgdGhlIG51bWJlciBvZiBwYXJ0aWNsZXMgYW5kIHRoZSBzdGVwIHNpemVcbiAgICAgICAgdmFyIG51bVBhcnRpY2xlcyA9IDUwO1xuICAgICAgICB2YXIgc3RlcFNpemUgPSBkaXN0YW5jZSAvIG51bVBhcnRpY2xlcztcbiAgICAgICAgLy8gU3Bhd24gcGFydGljbGVzIGFsb25nIHRoZSBsaW5lXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDw9IG51bVBhcnRpY2xlczsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgcG9zWCA9IHBsYXllclggKyBzdGVwWCAqIGkgKiBzdGVwU2l6ZTtcbiAgICAgICAgICAgIHZhciBwb3NZID0gcGxheWVyWSArIHN0ZXBZICogaSAqIHN0ZXBTaXplO1xuICAgICAgICAgICAgdmFyIHBvc1ogPSBwbGF5ZXJaICsgc3RlcFogKiBpICogc3RlcFNpemU7XG4gICAgICAgICAgICB3b3JsZC5zcGF3blBhcnRpY2xlKGVudW1QYXJ0aWNsZVNtb2tlLCBwb3NYLCBwb3NZLCBwb3NaLCAwLCAwLCAwLCBbMF0pO1xuICAgICAgICB9XG4gICAgICAgIC8vIEl0ZXJhdGUgdGhyb3VnaCBhbGwgZW50aXRpZXMgdG8gZmluZCB0aGUgb25lIHRoZSBwbGF5ZXIgaXMgbG9va2luZyBhdFxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGVudGl0aWVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBpZiAoIWVudGl0aWVzW2ldKSB7XG4gICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgZW50aXR5ID0gZW50aXRpZXNbaV07XG4gICAgICAgICAgICAvLyBDaGVjayBpZiB0aGUgZW50aXR5J3MgYm91bmRpbmcgYm94IGludGVyc2VjdHMgd2l0aCB0aGUgcGxheWVyJ3MgcmF5XG4gICAgICAgICAgICB2YXIgZW50aXR5QkIgPSBlbnRpdHkuZ2V0RW50aXR5Qm91bmRpbmdCb3goKS5leHBhbmQoMC4zLCAwLjMsIDAuMyk7XG4gICAgICAgICAgICB2YXIgaW50ZXJjZXB0ID0gZW50aXR5QkIuY2FsY3VsYXRlSW50ZXJjZXB0KGV5ZVBvc2l0aW9uLmdldFJlZigpLCB0YXJnZXRQb3NpdGlvbi5nZXRSZWYoKSk7XG4gICAgICAgICAgICBpZiAoaW50ZXJjZXB0ICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICB2YXIgZGlzdGFuY2VUb0VudGl0eSA9IGV5ZVBvc2l0aW9uLmRpc3RhbmNlVG8oaW50ZXJjZXB0LmhpdFZlYy5nZXRSZWYoKSk7XG4gICAgICAgICAgICAgICAgaWYgKGRpc3RhbmNlVG9FbnRpdHkgPCBjbG9zZXN0RGlzdGFuY2UpIHtcbiAgICAgICAgICAgICAgICAgICAgY2xvc2VzdERpc3RhbmNlID0gZGlzdGFuY2VUb0VudGl0eTtcbiAgICAgICAgICAgICAgICAgICAgY2xvc2VzdEVudGl0eSA9IGVudGl0eTtcbiAgICAgICAgICAgICAgICAgICAgaXNIZWFkc2hvdCA9IGVudGl0eS5nZXRQb3NpdGlvbkV5ZXMoMC4wKS5kaXN0YW5jZVRvKGludGVyY2VwdC5oaXRWZWMuZ2V0UmVmKCkpIDwgSEVBRFNIT1RfTUFYX0RJU1RBTkNFX0ZST01fSEVBRDtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGlzSGVhZHNob3QpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlzSGVhZHNob3RJbnQgPSAxO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHZhciByYXlUcmFjZVJlc3VsdCA9IGNsb3Nlc3RFbnRpdHk7XG4gICAgICAgIGlmIChyYXlUcmFjZVJlc3VsdCAhPSBudWxsKSB7XG4gICAgICAgICAgICByZXR1cm4geyBlbnRpdHk6IHJheVRyYWNlUmVzdWx0LCBoZWFkc2hvdDogaXNIZWFkc2hvdCwgaW50aGVhZHNob3Q6IGlzSGVhZHNob3RJbnQgfTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgfVxuICAgIE1vZEFQSS5yZWZsZWN0LnByb3RvdHlwZVN0YWNrKGl0ZW1DbGFzcywgbm1pX0Fzc2F1bHRSaWZsZSk7XG4gICAgdmFyIGhhc1Nob3QgPSBmYWxzZTtcbiAgICBubWlfQXNzYXVsdFJpZmxlLnByb3RvdHlwZS4kb25QbGF5ZXJTdG9wcGVkVXNpbmcgPSBmdW5jdGlvbiAoJGl0ZW1zdGFjaykge1xuICAgICAgICBoYXNTaG90ID0gZmFsc2U7XG4gICAgfTtcbiAgICBubWlfQXNzYXVsdFJpZmxlLnByb3RvdHlwZS4kb25JdGVtVXNlRmluaXNoID0gZnVuY3Rpb24gKCRpdGVtc3RhY2spIHtcbiAgICAgICAgcmV0dXJuICRpdGVtc3RhY2s7XG4gICAgfTtcbiAgICBubWlfQXNzYXVsdFJpZmxlLnByb3RvdHlwZS4kZ2V0TWF4SXRlbVVzZUR1cmF0aW9uID0gZnVuY3Rpb24gKCRpdGVtc3RhY2spIHtcbiAgICAgICAgcmV0dXJuIDcyMDAwO1xuICAgIH07XG4gICAgbm1pX0Fzc2F1bHRSaWZsZS5wcm90b3R5cGUuJGdldEl0ZW1Vc2VBY3Rpb24gPSBmdW5jdGlvbiAoJGl0ZW1zdGFjaykge1xuICAgICAgICByZXR1cm4gTW9kQVBJLnJlZmxlY3QuZ2V0Q2xhc3NCeU5hbWUoXCJFbnVtQWN0aW9uXCIpLnN0YXRpY1ZhcmlhYmxlcy5EUklOSztcbiAgICB9O1xuICAgIG5taV9Bc3NhdWx0UmlmbGUucHJvdG90eXBlLiRvbkl0ZW1SaWdodENsaWNrID0gZnVuY3Rpb24gKCRpdGVtc3RhY2ssICR3b3JsZCwgJHBsYXllcikge1xuICAgICAgICBpZiAoIWhhc1Nob3QpIHtcbiAgICAgICAgICAgIGhhc1Nob3QgPSB0cnVlO1xuICAgICAgICAgICAgdmFyIGNhY3R1cyA9IERhbWFnZVNvdXJjZUNsYXNzLnN0YXRpY1ZhcmlhYmxlcy5jYWN0dXM7XG4gICAgICAgICAgICB2YXIgd29ybGQgPSBNb2RBUEkudXRpbC53cmFwKCR3b3JsZCk7XG4gICAgICAgICAgICB2YXIgZW50aXR5cGxheWVyID0gTW9kQVBJLnV0aWwud3JhcCgkcGxheWVyKTtcbiAgICAgICAgICAgIHZhciBzaG90ZW50aXR5ZGF0YSA9IGVudGl0eVJheUNhc3QoZW50aXR5cGxheWVyLCB3b3JsZCwgMzIuMCk7XG4gICAgICAgICAgICBlbnRpdHlwbGF5ZXIuc2V0SXRlbUluVXNlKCRpdGVtc3RhY2ssIG5taV9Bc3NhdWx0UmlmbGUucHJvdG90eXBlLiRnZXRNYXhJdGVtVXNlRHVyYXRpb24oJGl0ZW1zdGFjaykpO1xuICAgICAgICAgICAgaWYgKHNob3RlbnRpdHlkYXRhICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICBpZiAod29ybGQuaXNSZW1vdGUpIHtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHNob3RlbnRpdHlkYXRhLmVudGl0eS5hdHRhY2tFbnRpdHlGcm9tKGNhY3R1cywgMTAgKyAoMTYgKiBzaG90ZW50aXR5ZGF0YS5pbnRoZWFkc2hvdCkpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoc2hvdGVudGl0eWRhdGEuaGVhZHNob3QpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiSCBFIEEgRCBTIEggTyBUXCIpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHdvcmxkLnBsYXlTb3VuZEF0RW50aXR5KGVudGl0eXBsYXllci5nZXRSZWYoKSwgTW9kQVBJLnV0aWwuc3RyKFwidGlsZS5waXN0b24ub3V0XCIpLCAxLjAsIDEuOCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoIXdvcmxkLmlzUmVtb3RlKSB7XG4gICAgICAgICAgICAgICAgd29ybGQucGxheVNvdW5kQXRFbnRpdHkoZW50aXR5cGxheWVyLmdldFJlZigpLCBNb2RBUEkudXRpbC5zdHIoXCJyYW5kb20uY2xpY2tcIiksIDEuMCwgMS44KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gJGl0ZW1zdGFjaztcbiAgICB9O1xuICAgIGZ1bmN0aW9uIGludGVybmFsX3JlZygpIHtcbiAgICAgICAgdmFyIGFyX2l0ZW0gPSAobmV3IG5taV9Bc3NhdWx0UmlmbGUoKSkuJHNldFVubG9jYWxpemVkTmFtZShNb2RBUEkudXRpbC5zdHIoXCJhc3NhdWx0cmlmbGVcIikpLiRzZXRNYXhTdGFja1NpemUoMSk7XG4gICAgICAgIGl0ZW1DbGFzcy5zdGF0aWNNZXRob2RzLnJlZ2lzdGVySXRlbS5tZXRob2QoTW9kQVBJLmtleWdlbi5pdGVtKFwiYXNzYXVsdHJpZmxlXCIpLCBNb2RBUEkudXRpbC5zdHIoXCJhc3NhdWx0cmlmbGVcIiksIGFyX2l0ZW0pO1xuICAgICAgICBNb2RBUEkuaXRlbXNbXCJhc3NhdWx0cmlmbGVcIl0gPSBhcl9pdGVtO1xuICAgICAgICByZXR1cm4gYXJfaXRlbTtcbiAgICB9XG4gICAgaWYgKE1vZEFQSS5pdGVtcykge1xuICAgICAgICByZXR1cm4gaW50ZXJuYWxfcmVnKCk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBNb2RBUEkuYWRkRXZlbnRMaXN0ZW5lcihcImJvb3RzdHJhcFwiLCBpbnRlcm5hbF9yZWcpO1xuICAgIH1cbn1cbiIsIlwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gUGlzdG9sSXRlbTtcbmZ1bmN0aW9uIFBpc3RvbEl0ZW0oKSB7XG4gICAgdmFyIERhbWFnZVNvdXJjZUNsYXNzID0gTW9kQVBJLnJlZmxlY3QuZ2V0Q2xhc3NCeU5hbWUoXCJEYW1hZ2VTb3VyY2VcIik7XG4gICAgdmFyIGNyZWF0aXZlTWlzY1RhYiA9IE1vZEFQSS5yZWZsZWN0LmdldENsYXNzQnlJZChcIm5ldC5taW5lY3JhZnQuY3JlYXRpdmV0YWIuQ3JlYXRpdmVUYWJzXCIpLnN0YXRpY1ZhcmlhYmxlcy50YWJNaXNjO1xuICAgIHZhciBpdGVtQ2xhc3MgPSBNb2RBUEkucmVmbGVjdC5nZXRDbGFzc0J5SWQoXCJuZXQubWluZWNyYWZ0Lml0ZW0uSXRlbVwiKTtcbiAgICB2YXIgaXRlbVN1cGVyID0gTW9kQVBJLnJlZmxlY3QuZ2V0U3VwZXIoaXRlbUNsYXNzLCBmdW5jdGlvbiAoeCkgeyByZXR1cm4geC5sZW5ndGggPT09IDE7IH0pO1xuICAgIHZhciBubWlfSXRlbVBpc3RvbCA9IGZ1bmN0aW9uIG5taV9JdGVtUGlzdG9sKCkge1xuICAgICAgICBpdGVtU3VwZXIodGhpcyk7IC8vVXNlIHN1cGVyIGZ1bmN0aW9uIHRvIGdldCBibG9jayBwcm9wZXJ0aWVzIG9uIHRoaXMgY2xhc3MuXG4gICAgICAgIHRoaXMuJHNldENyZWF0aXZlVGFiKGNyZWF0aXZlTWlzY1RhYik7XG4gICAgfTtcbiAgICBmdW5jdGlvbiBlbnRpdHlSYXlDYXN0KHBsYXllciwgd29ybGQsIHJhbmdlKSB7XG4gICAgICAgIHZhciBIRUFEU0hPVF9NQVhfRElTVEFOQ0VfRlJPTV9IRUFEID0gMC43MjtcbiAgICAgICAgdmFyIGV5ZVBvc2l0aW9uID0gcGxheWVyLmdldFBvc2l0aW9uRXllcygwLjApO1xuICAgICAgICB2YXIgdGFyZ2V0UG9zaXRpb24gPSBwbGF5ZXIucmF5VHJhY2UocmFuZ2UsIDApLmhpdFZlYztcbiAgICAgICAgdmFyIGVudGl0aWVzID0gd29ybGQuZ2V0RW50aXRpZXNXaXRoaW5BQUJCRXhjbHVkaW5nRW50aXR5KHBsYXllci5nZXRSZWYoKSwgcGxheWVyLmdldEVudGl0eUJvdW5kaW5nQm94KCkuZXhwYW5kKHJhbmdlLCByYW5nZSwgcmFuZ2UpLmdldFJlZigpKS5nZXRDb3JyZWN0aXZlKCkuYXJyYXk7XG4gICAgICAgIHZhciBjbG9zZXN0RW50aXR5ID0gbnVsbDtcbiAgICAgICAgdmFyIGlzSGVhZHNob3QgPSBmYWxzZTtcbiAgICAgICAgdmFyIGlzSGVhZHNob3RJbnQgPSAwO1xuICAgICAgICB2YXIgY2xvc2VzdERpc3RhbmNlID0gcmFuZ2U7XG4gICAgICAgIC8vIEl0ZXJhdGUgdGhyb3VnaCBhbGwgZW50aXRpZXMgdG8gZmluZCB0aGUgb25lIHRoZSBwbGF5ZXIgaXMgbG9va2luZyBhdFxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGVudGl0aWVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBpZiAoIWVudGl0aWVzW2ldKSB7XG4gICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgZW50aXR5ID0gZW50aXRpZXNbaV07XG4gICAgICAgICAgICAvLyBDaGVjayBpZiB0aGUgZW50aXR5J3MgYm91bmRpbmcgYm94IGludGVyc2VjdHMgd2l0aCB0aGUgcGxheWVyJ3MgcmF5XG4gICAgICAgICAgICB2YXIgZW50aXR5QkIgPSBlbnRpdHkuZ2V0RW50aXR5Qm91bmRpbmdCb3goKS5leHBhbmQoMC4zLCAwLjMsIDAuMyk7XG4gICAgICAgICAgICB2YXIgaW50ZXJjZXB0ID0gZW50aXR5QkIuY2FsY3VsYXRlSW50ZXJjZXB0KGV5ZVBvc2l0aW9uLmdldFJlZigpLCB0YXJnZXRQb3NpdGlvbi5nZXRSZWYoKSk7XG4gICAgICAgICAgICBpZiAoaW50ZXJjZXB0ICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICB2YXIgZGlzdGFuY2UgPSBleWVQb3NpdGlvbi5kaXN0YW5jZVRvKGludGVyY2VwdC5oaXRWZWMuZ2V0UmVmKCkpO1xuICAgICAgICAgICAgICAgIGlmIChkaXN0YW5jZSA8IGNsb3Nlc3REaXN0YW5jZSkge1xuICAgICAgICAgICAgICAgICAgICBjbG9zZXN0RGlzdGFuY2UgPSBkaXN0YW5jZTtcbiAgICAgICAgICAgICAgICAgICAgY2xvc2VzdEVudGl0eSA9IGVudGl0eTtcbiAgICAgICAgICAgICAgICAgICAgaXNIZWFkc2hvdCA9IGVudGl0eS5nZXRQb3NpdGlvbkV5ZXMoMC4wKS5kaXN0YW5jZVRvKGludGVyY2VwdC5oaXRWZWMuZ2V0UmVmKCkpIDwgSEVBRFNIT1RfTUFYX0RJU1RBTkNFX0ZST01fSEVBRDtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGlzSGVhZHNob3QpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlzSGVhZHNob3RJbnQgPSAxO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHZhciByYXlUcmFjZVJlc3VsdCA9IGNsb3Nlc3RFbnRpdHk7XG4gICAgICAgIGlmIChyYXlUcmFjZVJlc3VsdCAhPSBudWxsKSB7XG4gICAgICAgICAgICByZXR1cm4geyBlbnRpdHk6IHJheVRyYWNlUmVzdWx0LCBoZWFkc2hvdDogaXNIZWFkc2hvdCwgaW50aGVhZHNob3Q6IGlzSGVhZHNob3RJbnQgfTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgfVxuICAgIE1vZEFQSS5yZWZsZWN0LnByb3RvdHlwZVN0YWNrKGl0ZW1DbGFzcywgbm1pX0l0ZW1QaXN0b2wpO1xuICAgIG5taV9JdGVtUGlzdG9sLnByb3RvdHlwZS4kb25JdGVtUmlnaHRDbGljayA9IGZ1bmN0aW9uICgkaXRlbXN0YWNrLCAkd29ybGQsICRwbGF5ZXIpIHtcbiAgICAgICAgdmFyIGNhY3R1cyA9IERhbWFnZVNvdXJjZUNsYXNzLnN0YXRpY1ZhcmlhYmxlcy5jYWN0dXM7XG4gICAgICAgIHZhciB3b3JsZCA9IE1vZEFQSS51dGlsLndyYXAoJHdvcmxkKTtcbiAgICAgICAgdmFyIGVudGl0eXBsYXllciA9IE1vZEFQSS51dGlsLndyYXAoJHBsYXllcik7XG4gICAgICAgIHZhciBzaG90ZW50aXR5ZGF0YSA9IGVudGl0eVJheUNhc3QoZW50aXR5cGxheWVyLCB3b3JsZCwgMTYuMCk7XG4gICAgICAgIGlmIChzaG90ZW50aXR5ZGF0YSAhPSBudWxsKSB7XG4gICAgICAgICAgICBpZiAod29ybGQuaXNSZW1vdGUpIHtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHNob3RlbnRpdHlkYXRhLmVudGl0eS5hdHRhY2tFbnRpdHlGcm9tKGNhY3R1cywgMTAgKyAoMTYgKiBzaG90ZW50aXR5ZGF0YS5pbnRoZWFkc2hvdCkpO1xuICAgICAgICAgICAgICAgIGlmIChzaG90ZW50aXR5ZGF0YS5oZWFkc2hvdCkge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkggRSBBIEQgUyBIIE8gVFwiKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgd29ybGQucGxheVNvdW5kQXRFbnRpdHkoZW50aXR5cGxheWVyLmdldFJlZigpLCBNb2RBUEkudXRpbC5zdHIoXCJ0aWxlLnBpc3Rvbi5vdXRcIiksIDEuMCwgMS44KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICghd29ybGQuaXNSZW1vdGUpIHtcbiAgICAgICAgICAgIHdvcmxkLnBsYXlTb3VuZEF0RW50aXR5KGVudGl0eXBsYXllci5nZXRSZWYoKSwgTW9kQVBJLnV0aWwuc3RyKFwicmFuZG9tLmNsaWNrXCIpLCAxLjAsIDEuOCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuICRpdGVtc3RhY2s7XG4gICAgfTtcbiAgICBmdW5jdGlvbiBpbnRlcm5hbF9yZWcoKSB7XG4gICAgICAgIHZhciBwaXN0b2xfaXRlbSA9IChuZXcgbm1pX0l0ZW1QaXN0b2woKSkuJHNldFVubG9jYWxpemVkTmFtZShNb2RBUEkudXRpbC5zdHIoXCJwaXN0b2xcIikpLiRzZXRNYXhTdGFja1NpemUoMSk7XG4gICAgICAgIGl0ZW1DbGFzcy5zdGF0aWNNZXRob2RzLnJlZ2lzdGVySXRlbS5tZXRob2QoTW9kQVBJLmtleWdlbi5pdGVtKFwicGlzdG9sXCIpLCBNb2RBUEkudXRpbC5zdHIoXCJwaXN0b2xcIiksIHBpc3RvbF9pdGVtKTtcbiAgICAgICAgTW9kQVBJLml0ZW1zW1wicGlzdG9sXCJdID0gcGlzdG9sX2l0ZW07XG4gICAgICAgIHJldHVybiBwaXN0b2xfaXRlbTtcbiAgICB9XG4gICAgaWYgKE1vZEFQSS5pdGVtcykge1xuICAgICAgICByZXR1cm4gaW50ZXJuYWxfcmVnKCk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBNb2RBUEkuYWRkRXZlbnRMaXN0ZW5lcihcImJvb3RzdHJhcFwiLCBpbnRlcm5hbF9yZWcpO1xuICAgIH1cbn1cbiIsIlwidXNlIHN0cmljdFwiO1xudmFyIF9fYXdhaXRlciA9ICh0aGlzICYmIHRoaXMuX19hd2FpdGVyKSB8fCBmdW5jdGlvbiAodGhpc0FyZywgX2FyZ3VtZW50cywgUCwgZ2VuZXJhdG9yKSB7XG4gICAgZnVuY3Rpb24gYWRvcHQodmFsdWUpIHsgcmV0dXJuIHZhbHVlIGluc3RhbmNlb2YgUCA/IHZhbHVlIDogbmV3IFAoZnVuY3Rpb24gKHJlc29sdmUpIHsgcmVzb2x2ZSh2YWx1ZSk7IH0pOyB9XG4gICAgcmV0dXJuIG5ldyAoUCB8fCAoUCA9IFByb21pc2UpKShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgIGZ1bmN0aW9uIGZ1bGZpbGxlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvci5uZXh0KHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cbiAgICAgICAgZnVuY3Rpb24gcmVqZWN0ZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3JbXCJ0aHJvd1wiXSh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XG4gICAgICAgIGZ1bmN0aW9uIHN0ZXAocmVzdWx0KSB7IHJlc3VsdC5kb25lID8gcmVzb2x2ZShyZXN1bHQudmFsdWUpIDogYWRvcHQocmVzdWx0LnZhbHVlKS50aGVuKGZ1bGZpbGxlZCwgcmVqZWN0ZWQpOyB9XG4gICAgICAgIHN0ZXAoKGdlbmVyYXRvciA9IGdlbmVyYXRvci5hcHBseSh0aGlzQXJnLCBfYXJndW1lbnRzIHx8IFtdKSkubmV4dCgpKTtcbiAgICB9KTtcbn07XG52YXIgX19nZW5lcmF0b3IgPSAodGhpcyAmJiB0aGlzLl9fZ2VuZXJhdG9yKSB8fCBmdW5jdGlvbiAodGhpc0FyZywgYm9keSkge1xuICAgIHZhciBfID0geyBsYWJlbDogMCwgc2VudDogZnVuY3Rpb24oKSB7IGlmICh0WzBdICYgMSkgdGhyb3cgdFsxXTsgcmV0dXJuIHRbMV07IH0sIHRyeXM6IFtdLCBvcHM6IFtdIH0sIGYsIHksIHQsIGcgPSBPYmplY3QuY3JlYXRlKCh0eXBlb2YgSXRlcmF0b3IgPT09IFwiZnVuY3Rpb25cIiA/IEl0ZXJhdG9yIDogT2JqZWN0KS5wcm90b3R5cGUpO1xuICAgIHJldHVybiBnLm5leHQgPSB2ZXJiKDApLCBnW1widGhyb3dcIl0gPSB2ZXJiKDEpLCBnW1wicmV0dXJuXCJdID0gdmVyYigyKSwgdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIChnW1N5bWJvbC5pdGVyYXRvcl0gPSBmdW5jdGlvbigpIHsgcmV0dXJuIHRoaXM7IH0pLCBnO1xuICAgIGZ1bmN0aW9uIHZlcmIobikgeyByZXR1cm4gZnVuY3Rpb24gKHYpIHsgcmV0dXJuIHN0ZXAoW24sIHZdKTsgfTsgfVxuICAgIGZ1bmN0aW9uIHN0ZXAob3ApIHtcbiAgICAgICAgaWYgKGYpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJHZW5lcmF0b3IgaXMgYWxyZWFkeSBleGVjdXRpbmcuXCIpO1xuICAgICAgICB3aGlsZSAoZyAmJiAoZyA9IDAsIG9wWzBdICYmIChfID0gMCkpLCBfKSB0cnkge1xuICAgICAgICAgICAgaWYgKGYgPSAxLCB5ICYmICh0ID0gb3BbMF0gJiAyID8geVtcInJldHVyblwiXSA6IG9wWzBdID8geVtcInRocm93XCJdIHx8ICgodCA9IHlbXCJyZXR1cm5cIl0pICYmIHQuY2FsbCh5KSwgMCkgOiB5Lm5leHQpICYmICEodCA9IHQuY2FsbCh5LCBvcFsxXSkpLmRvbmUpIHJldHVybiB0O1xuICAgICAgICAgICAgaWYgKHkgPSAwLCB0KSBvcCA9IFtvcFswXSAmIDIsIHQudmFsdWVdO1xuICAgICAgICAgICAgc3dpdGNoIChvcFswXSkge1xuICAgICAgICAgICAgICAgIGNhc2UgMDogY2FzZSAxOiB0ID0gb3A7IGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgNDogXy5sYWJlbCsrOyByZXR1cm4geyB2YWx1ZTogb3BbMV0sIGRvbmU6IGZhbHNlIH07XG4gICAgICAgICAgICAgICAgY2FzZSA1OiBfLmxhYmVsKys7IHkgPSBvcFsxXTsgb3AgPSBbMF07IGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIGNhc2UgNzogb3AgPSBfLm9wcy5wb3AoKTsgXy50cnlzLnBvcCgpOyBjb250aW51ZTtcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICBpZiAoISh0ID0gXy50cnlzLCB0ID0gdC5sZW5ndGggPiAwICYmIHRbdC5sZW5ndGggLSAxXSkgJiYgKG9wWzBdID09PSA2IHx8IG9wWzBdID09PSAyKSkgeyBfID0gMDsgY29udGludWU7IH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKG9wWzBdID09PSAzICYmICghdCB8fCAob3BbMV0gPiB0WzBdICYmIG9wWzFdIDwgdFszXSkpKSB7IF8ubGFiZWwgPSBvcFsxXTsgYnJlYWs7IH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKG9wWzBdID09PSA2ICYmIF8ubGFiZWwgPCB0WzFdKSB7IF8ubGFiZWwgPSB0WzFdOyB0ID0gb3A7IGJyZWFrOyB9XG4gICAgICAgICAgICAgICAgICAgIGlmICh0ICYmIF8ubGFiZWwgPCB0WzJdKSB7IF8ubGFiZWwgPSB0WzJdOyBfLm9wcy5wdXNoKG9wKTsgYnJlYWs7IH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKHRbMl0pIF8ub3BzLnBvcCgpO1xuICAgICAgICAgICAgICAgICAgICBfLnRyeXMucG9wKCk7IGNvbnRpbnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgb3AgPSBib2R5LmNhbGwodGhpc0FyZywgXyk7XG4gICAgICAgIH0gY2F0Y2ggKGUpIHsgb3AgPSBbNiwgZV07IHkgPSAwOyB9IGZpbmFsbHkgeyBmID0gdCA9IDA7IH1cbiAgICAgICAgaWYgKG9wWzBdICYgNSkgdGhyb3cgb3BbMV07IHJldHVybiB7IHZhbHVlOiBvcFswXSA/IG9wWzFdIDogdm9pZCAwLCBkb25lOiB0cnVlIH07XG4gICAgfVxufTtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBQaXN0b2xfMSA9IHJlcXVpcmUoXCIuL2d1bnMvUGlzdG9sXCIpO1xudmFyIEFzc2F1bHRSaWZsZV8xID0gcmVxdWlyZShcIi4vZ3Vucy9Bc3NhdWx0UmlmbGVcIik7XG52YXIgaXRlbVRleHR1cmUgPSBcImRhdGE6aW1hZ2UvcG5nO2Jhc2U2NCxpVkJPUncwS0dnb0FBQUFOU1VoRVVnQUFBQ0FBQUFBZ0NBWUFBQUJ6ZW5yMEFBQUFBWE5TUjBJQXJzNGM2UUFBQUFSblFVMUJBQUN4and2OFlRVUFBQUFKY0VoWmN3QUFEc01BQUE3REFjZHZxR1FBQUFEeVNVUkJWRmhIN1pReERvTXdERVZOcjRHNlZtSkM2bWs0SXRkaDdWcHhqc0JQRGFLVkNMWnh5cEluSWNjZzV6cy9DVlFvS0FqOHVITGplRVRvdW82SHZsUWNVM3lKOTMyUElLa1RjZVJBRkg4TkE2ZEUzSXpiVm9nZFFCT1B0dVZYZms1SUo4aldoS1k0U3hQYVF2Y21MRVd1VFVqL0Exc3FpRUVjVFFCRU5EV2p2aDNtdlp0eGNjTGl3TXF2RTBEcmhOVUJDQ3kxS1NkQVVzUGl3RlljcE01RU5yWVdoM3RkSTRjVDRkazBNU0tQWHpNU1JTQytQTWkxNG1jTzRlN2VzdjJpSnF5SEVHRFZQQ1I2anlNQzVsdUVSWE9mdW9ZN1FGaThNS3NEZTZ0WGs4T0J2N0dlL0U5NkRaZUtGd29PRUUxd1VYN1RGaDV6c2dBQUFBQkpSVTVFcmtKZ2dnPT1cIjtcbk1vZEFQSS5tZXRhLnRpdGxlKFwiRG9udXQncyBHdW4gTW9kXCIpO1xuTW9kQVBJLm1ldGEudmVyc2lvbihcIndJUFwiKTtcbk1vZEFQSS5tZXRhLmljb24oaXRlbVRleHR1cmUpO1xuTW9kQVBJLm1ldGEuZGVzY3JpcHRpb24oXCJSZXF1aXJlcyBBc3luY1NpbmsuIFNvIGZhciBqdXN0IHNraWRkZWQgY29kZSBmcm9tIHJhZG1hblwiKTtcbk1vZEFQSS5kZWRpY2F0ZWRTZXJ2ZXIuYXBwZW5kQ29kZShQaXN0b2xfMS5kZWZhdWx0KTtcbk1vZEFQSS5kZWRpY2F0ZWRTZXJ2ZXIuYXBwZW5kQ29kZShBc3NhdWx0UmlmbGVfMS5kZWZhdWx0KTtcbnZhciBwaXN0b2xfaXRlbSA9ICgwLCBQaXN0b2xfMS5kZWZhdWx0KSgpO1xudmFyIGFyX2l0ZW0gPSAoMCwgQXNzYXVsdFJpZmxlXzEuZGVmYXVsdCkoKTtcbk1vZEFQSS5hZGRFdmVudExpc3RlbmVyKFwibGliOmFzeW5jc2lua1wiLCBmdW5jdGlvbiAoKSB7IHJldHVybiBfX2F3YWl0ZXIodm9pZCAwLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgIHZhciBfYSwgX2IsIF9jO1xuICAgIHJldHVybiBfX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2QpIHtcbiAgICAgICAgc3dpdGNoIChfZC5sYWJlbCkge1xuICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgIE1vZEFQSS5hZGRFdmVudExpc3RlbmVyKFwiY3VzdG9tOmFzeW5jc2lua19yZWxvYWRlZFwiLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIE1vZEFQSS5tYy5yZW5kZXJJdGVtLnJlZ2lzdGVySXRlbShwaXN0b2xfaXRlbSwgTW9kQVBJLnV0aWwuc3RyKFwicGlzdG9sXCIpKTtcbiAgICAgICAgICAgICAgICAgICAgTW9kQVBJLm1jLnJlbmRlckl0ZW0ucmVnaXN0ZXJJdGVtKGFyX2l0ZW0sIE1vZEFQSS51dGlsLnN0cihcImFzc2F1bHRyaWZsZVwiKSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgQXN5bmNTaW5rLkwxME4uc2V0KFwiaXRlbS5waXN0b2wubmFtZVwiLCBcIlBpc3RvbFwiKTtcbiAgICAgICAgICAgICAgICBBc3luY1NpbmsuTDEwTi5zZXQoXCJpdGVtLmFzc2F1bHRyaWZsZS5uYW1lXCIsIFwiQXNzYXVsdCBSaWZsZVwiKTtcbiAgICAgICAgICAgICAgICBBc3luY1Npbmsuc2V0RmlsZShcInJlc291cmNlcGFja3MvQXN5bmNTaW5rTGliL2Fzc2V0cy9taW5lY3JhZnQvbW9kZWxzL2l0ZW0vcGlzdG9sLmpzb25cIiwgSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgICAgICAgICAgICBcInBhcmVudFwiOiBcImJ1aWx0aW4vZ2VuZXJhdGVkXCIsXG4gICAgICAgICAgICAgICAgICAgIFwidGV4dHVyZXNcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJsYXllcjBcIjogXCJpdGVtcy9waXN0b2xcIlxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBcImRpc3BsYXlcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJ0aGlyZHBlcnNvblwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJyb3RhdGlvblwiOiBbNSwgODAsIC00NV0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ0cmFuc2xhdGlvblwiOiBbMCwgMSwgLTNdLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwic2NhbGVcIjogWzEuMCwgMS4wLCAxLjBdXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJmaXJzdHBlcnNvblwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJyb3RhdGlvblwiOiBbMCwgLTEzNSwgMjVdLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwidHJhbnNsYXRpb25cIjogWzAsIDQsIDJdLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwic2NhbGVcIjogWzEuOCwgMS44LCAxLjhdXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICAgICAgX2IgPSAoX2EgPSBBc3luY1NpbmspLnNldEZpbGU7XG4gICAgICAgICAgICAgICAgX2MgPSBbXCJyZXNvdXJjZXBhY2tzL0FzeW5jU2lua0xpYi9hc3NldHMvbWluZWNyYWZ0L3RleHR1cmVzL2l0ZW1zL3Bpc3RvbC5wbmdcIl07XG4gICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgZmV0Y2goaXRlbVRleHR1cmUpXTtcbiAgICAgICAgICAgIGNhc2UgMTogcmV0dXJuIFs0IC8qeWllbGQqLywgKF9kLnNlbnQoKSkuYXJyYXlCdWZmZXIoKV07XG4gICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAgX2IuYXBwbHkoX2EsIF9jLmNvbmNhdChbX2Quc2VudCgpXSkpO1xuICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovXTtcbiAgICAgICAgfVxuICAgIH0pO1xufSk7IH0pO1xuIiwiLy8gVGhlIG1vZHVsZSBjYWNoZVxudmFyIF9fd2VicGFja19tb2R1bGVfY2FjaGVfXyA9IHt9O1xuXG4vLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcblx0dmFyIGNhY2hlZE1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF07XG5cdGlmIChjYWNoZWRNb2R1bGUgIT09IHVuZGVmaW5lZCkge1xuXHRcdHJldHVybiBjYWNoZWRNb2R1bGUuZXhwb3J0cztcblx0fVxuXHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuXHR2YXIgbW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXSA9IHtcblx0XHQvLyBubyBtb2R1bGUuaWQgbmVlZGVkXG5cdFx0Ly8gbm8gbW9kdWxlLmxvYWRlZCBuZWVkZWRcblx0XHRleHBvcnRzOiB7fVxuXHR9O1xuXG5cdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuXHRfX3dlYnBhY2tfbW9kdWxlc19fW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuXHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuXHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG59XG5cbiIsIi8vIHN0YXJ0dXBcbi8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuLy8gVGhpcyBlbnRyeSBtb2R1bGUgaXMgcmVmZXJlbmNlZCBieSBvdGhlciBtb2R1bGVzIHNvIGl0IGNhbid0IGJlIGlubGluZWRcbnZhciBfX3dlYnBhY2tfZXhwb3J0c19fID0gX193ZWJwYWNrX3JlcXVpcmVfXyhcIi4vc3JjL21haW4udHNcIik7XG4iXSwibmFtZXMiOlsiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJleHBvcnRzIiwidmFsdWUiLCJEYW1hZ2VTb3VyY2VDbGFzcyIsIk1vZEFQSSIsInJlZmxlY3QiLCJnZXRDbGFzc0J5TmFtZSIsImNyZWF0aXZlTWlzY1RhYiIsImdldENsYXNzQnlJZCIsInN0YXRpY1ZhcmlhYmxlcyIsInRhYk1pc2MiLCJpdGVtQ2xhc3MiLCJpdGVtU3VwZXIiLCJnZXRTdXBlciIsIngiLCJsZW5ndGgiLCJubWlfQXNzYXVsdFJpZmxlIiwidGhpcyIsIiRzZXRDcmVhdGl2ZVRhYiIsInByb3RvdHlwZVN0YWNrIiwiaGFzU2hvdCIsImludGVybmFsX3JlZyIsImFyX2l0ZW0iLCIkc2V0VW5sb2NhbGl6ZWROYW1lIiwidXRpbCIsInN0ciIsIiRzZXRNYXhTdGFja1NpemUiLCJzdGF0aWNNZXRob2RzIiwicmVnaXN0ZXJJdGVtIiwibWV0aG9kIiwia2V5Z2VuIiwiaXRlbSIsIml0ZW1zIiwicHJvdG90eXBlIiwiJG9uUGxheWVyU3RvcHBlZFVzaW5nIiwiJGl0ZW1zdGFjayIsIiRvbkl0ZW1Vc2VGaW5pc2giLCIkZ2V0TWF4SXRlbVVzZUR1cmF0aW9uIiwiJGdldEl0ZW1Vc2VBY3Rpb24iLCJEUklOSyIsIiRvbkl0ZW1SaWdodENsaWNrIiwiJHdvcmxkIiwiJHBsYXllciIsImNhY3R1cyIsIndvcmxkIiwid3JhcCIsImVudGl0eXBsYXllciIsInNob3RlbnRpdHlkYXRhIiwicGxheWVyIiwiZXllUG9zaXRpb24iLCJnZXRQb3NpdGlvbkV5ZXMiLCJ0YXJnZXRQb3NpdGlvbiIsInJheVRyYWNlIiwiaGl0VmVjIiwiZW50aXRpZXMiLCJnZXRFbnRpdGllc1dpdGhpbkFBQkJFeGNsdWRpbmdFbnRpdHkiLCJnZXRSZWYiLCJnZXRFbnRpdHlCb3VuZGluZ0JveCIsImV4cGFuZCIsImdldENvcnJlY3RpdmUiLCJhcnJheSIsImNsb3Nlc3RFbnRpdHkiLCJpc0hlYWRzaG90IiwiaXNIZWFkc2hvdEludCIsImNsb3Nlc3REaXN0YW5jZSIsImVudW1QYXJ0aWNsZVNtb2tlIiwiU01PS0VfTk9STUFMIiwicGxheWVyWCIsInBvc1giLCJwbGF5ZXJZIiwicG9zWSIsInBsYXllcloiLCJwb3NaIiwiZGlyWCIsInhDb29yZCIsImRpclkiLCJ5Q29vcmQiLCJkaXJaIiwiekNvb3JkIiwiZGlzdGFuY2UiLCJNYXRoIiwic3FydCIsInN0ZXBYIiwic3RlcFkiLCJzdGVwWiIsInN0ZXBTaXplIiwiaSIsInNwYXduUGFydGljbGUiLCJlbnRpdHkiLCJpbnRlcmNlcHQiLCJjYWxjdWxhdGVJbnRlcmNlcHQiLCJkaXN0YW5jZVRvRW50aXR5IiwiZGlzdGFuY2VUbyIsImhlYWRzaG90IiwiaW50aGVhZHNob3QiLCJlbnRpdHlSYXlDYXN0Iiwic2V0SXRlbUluVXNlIiwiaXNSZW1vdGUiLCJhdHRhY2tFbnRpdHlGcm9tIiwiY29uc29sZSIsImxvZyIsInBsYXlTb3VuZEF0RW50aXR5IiwiYWRkRXZlbnRMaXN0ZW5lciIsIm5taV9JdGVtUGlzdG9sIiwicGlzdG9sX2l0ZW0iLCJfX2F3YWl0ZXIiLCJ0aGlzQXJnIiwiX2FyZ3VtZW50cyIsIlAiLCJnZW5lcmF0b3IiLCJQcm9taXNlIiwicmVzb2x2ZSIsInJlamVjdCIsImZ1bGZpbGxlZCIsInN0ZXAiLCJuZXh0IiwiZSIsInJlamVjdGVkIiwicmVzdWx0IiwiZG9uZSIsInRoZW4iLCJhcHBseSIsIl9fZ2VuZXJhdG9yIiwiYm9keSIsImYiLCJ5IiwidCIsIl8iLCJsYWJlbCIsInNlbnQiLCJ0cnlzIiwib3BzIiwiZyIsImNyZWF0ZSIsIkl0ZXJhdG9yIiwidmVyYiIsIlN5bWJvbCIsIml0ZXJhdG9yIiwibiIsInYiLCJvcCIsIlR5cGVFcnJvciIsImNhbGwiLCJwb3AiLCJwdXNoIiwiUGlzdG9sXzEiLCJBc3NhdWx0UmlmbGVfMSIsIml0ZW1UZXh0dXJlIiwibWV0YSIsInRpdGxlIiwidmVyc2lvbiIsImljb24iLCJkZXNjcmlwdGlvbiIsImRlZGljYXRlZFNlcnZlciIsImFwcGVuZENvZGUiLCJkZWZhdWx0IiwiX2EiLCJfYiIsIl9jIiwiX2QiLCJtYyIsInJlbmRlckl0ZW0iLCJBc3luY1NpbmsiLCJMMTBOIiwic2V0Iiwic2V0RmlsZSIsIkpTT04iLCJzdHJpbmdpZnkiLCJmZXRjaCIsImFycmF5QnVmZmVyIiwiY29uY2F0IiwiX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiY2FjaGVkTW9kdWxlIiwidW5kZWZpbmVkIiwibW9kdWxlIiwiX193ZWJwYWNrX21vZHVsZXNfXyJdLCJzb3VyY2VSb290IjoiIn0=