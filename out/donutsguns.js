/*! For license information please see donutsguns.js.LICENSE.txt */
(()=>{"use strict";var t={"./src/guns/AssaultRifle.ts":(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(){var t=1,e=ModAPI.reflect.getClassByName("DamageSource"),n=ModAPI.reflect.getClassById("net.minecraft.creativetab.CreativeTabs").staticVariables.tabMisc,i=ModAPI.reflect.getClassById("net.minecraft.item.Item"),r=ModAPI.reflect.getSuper(i,(function(t){return 1===t.length})),o=function(){r(this),this.$setCreativeTab(n)};ModAPI.addEventListener("update",(function(){ModAPI.player.rotationPitch-=t,t*=.7})),ModAPI.reflect.prototypeStack(i,o);var a=!1;function s(){var t=(new o).$setUnlocalizedName(ModAPI.util.str("assaultrifle")).$setMaxStackSize(1);return i.staticMethods.registerItem.method(ModAPI.keygen.item("assaultrifle"),ModAPI.util.str("assaultrifle"),t),ModAPI.items.assaultrifle=t,t}if(o.prototype.$onPlayerStoppedUsing=function(t){a=!1},o.prototype.$onItemUseFinish=function(t){return t},o.prototype.$getMaxItemUseDuration=function(t){return 72e3},o.prototype.$getItemUseAction=function(t){return ModAPI.reflect.getClassByName("EnumAction").staticVariables.DRINK},o.prototype.$onItemRightClick=function(n,i,r){if(!a){a=!0;var s=e.staticVariables.cactus,c=ModAPI.util.wrap(i),l=ModAPI.util.wrap(r),u=function(t,e){for(var n=t.getPositionEyes(0),i=t.rayTrace(32,0).hitVec,r=e.getEntitiesWithinAABBExcludingEntity(t.getRef(),t.getEntityBoundingBox().expand(32,32,32).getRef()).getCorrective().array,o=null,a=!1,s=0,c=32,l=0;l<r.length;l++)if(r[l]){var u=r[l],d=u.getEntityBoundingBox().expand(.3,.3,.3).calculateIntercept(n.getRef(),i.getRef());if(null!=d){var f=n.distanceTo(d.hitVec.getRef());f<c&&(c=f,o=u,(a=u.getPositionEyes(0).distanceTo(d.hitVec.getRef())<.72)&&(s=1))}}return null!=o?{entity:o,headshot:a,intheadshot:s}:null}(l,c);l.setItemInUse(n,o.prototype.$getMaxItemUseDuration(n)),null!=u?c.isRemote?t+=4:(u.entity.attackEntityFrom(s,10+16*u.intheadshot),u.headshot&&console.log("H E A D S H O T"),c.playSoundAtEntity(l.getRef(),ModAPI.util.str("tile.piston.out"),1,1.8)):c.isRemote||c.playSoundAtEntity(l.getRef(),ModAPI.util.str("random.click"),1,1.8)}return n},ModAPI.items)return s();ModAPI.addEventListener("bootstrap",s)}},"./src/guns/Pistol.ts":(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(){var t=1,e=ModAPI.reflect.getClassByName("DamageSource"),n=ModAPI.reflect.getClassById("net.minecraft.creativetab.CreativeTabs").staticVariables.tabMisc,i=ModAPI.reflect.getClassById("net.minecraft.item.Item"),r=ModAPI.reflect.getSuper(i,(function(t){return 1===t.length})),o=function(){r(this),this.$setCreativeTab(n)};function a(){var t=(new o).$setUnlocalizedName(ModAPI.util.str("pistol")).$setMaxStackSize(1);return i.staticMethods.registerItem.method(ModAPI.keygen.item("pistol"),ModAPI.util.str("pistol"),t),ModAPI.items.pistol=t,t}if(ModAPI.addEventListener("update",(function(){ModAPI.player.rotationPitch-=t,t*=.7})),ModAPI.reflect.prototypeStack(i,o),o.prototype.$onItemRightClick=function(n,i,r){var o=e.staticVariables.cactus,a=ModAPI.util.wrap(i),s=ModAPI.util.wrap(r),c=function(t,e){for(var n=t.getPositionEyes(0),i=t.rayTrace(16,0).hitVec,r=e.getEntitiesWithinAABBExcludingEntity(t.getRef(),t.getEntityBoundingBox().expand(16,16,16).getRef()).getCorrective().array,o=null,a=!1,s=0,c=16,l=0;l<r.length;l++)if(r[l]){var u=r[l],d=u.getEntityBoundingBox().expand(.3,.3,.3).calculateIntercept(n.getRef(),i.getRef());if(null!=d){var f=n.distanceTo(d.hitVec.getRef());f<c&&(c=f,o=u,(a=u.getPositionEyes(0).distanceTo(d.hitVec.getRef())<.72)&&(s=1))}}return null!=o?{entity:o,headshot:a,intheadshot:s}:null}(s,a);return null!=c?a.isRemote?t+=4:(c.entity.attackEntityFrom(o,10+16*c.intheadshot),c.headshot&&console.log("H E A D S H O T"),a.playSoundAtEntity(s.getRef(),ModAPI.util.str("tile.piston.out"),1,1.8)):a.isRemote||a.playSoundAtEntity(s.getRef(),ModAPI.util.str("random.click"),1,1.8),n},ModAPI.items)return a();ModAPI.addEventListener("bootstrap",a)}},"./src/main.ts":function(t,e,n){var i=this&&this.__awaiter||function(t,e,n,i){return new(n||(n=Promise))((function(r,o){function a(t){try{c(i.next(t))}catch(t){o(t)}}function s(t){try{c(i.throw(t))}catch(t){o(t)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}c((i=i.apply(t,e||[])).next())}))},r=this&&this.__generator||function(t,e){var n,i,r,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(o=0)),o;)try{if(n=1,i&&(r=2&s[0]?i.return:s[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,s[1])).done)return r;switch(i=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,i=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!((r=(r=o.trys).length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){o.label=s[1];break}if(6===s[0]&&o.label<r[1]){o.label=r[1],r=s;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(s);break}r[2]&&o.ops.pop(),o.trys.pop();continue}s=e.call(t,o)}catch(t){s=[6,t],i=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}};Object.defineProperty(e,"__esModule",{value:!0});var o=n("./src/guns/Pistol.ts"),a=n("./src/guns/AssaultRifle.ts"),s="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAADySURBVFhH7ZQxDoMwDEVNr4G6VmJC6mk4Itdh7VpxjsBPDaKVCLZxypInIccg5zs/CVQoKAj8uHLjeETouo6HvlQcU3yJ932PIKkTceRAFH8NA6dE3IzbVogdQBOPtuVXfk5IJ8jWhKY4SxPaQvcmLEWuTUj/A1sqiEEcTQBENDWjvh3mvZtxccLiwMqvE0DrhNUBCCy1KSdAUsPiwFYcpM5ENrYWh3tdI4cT4dk0MSKPXzMSRSC+PMi14mcO4e7esv2iJqyHEGDVPCR6jyMC5luERXOfuoY7QFi8MKsDe6tXk8OBv7Ge/E96DZeKFwoOEE1wUX7TFh5zsgAAAABJRU5ErkJggg==";ModAPI.meta.title("Donut's Gun Mod"),ModAPI.meta.version("wIP"),ModAPI.meta.icon(s),ModAPI.meta.description("Requires AsyncSink. So far just skidded code from radman"),ModAPI.dedicatedServer.appendCode(o.default),ModAPI.dedicatedServer.appendCode(a.default);var c=(0,o.default)(),l=(0,a.default)();ModAPI.addEventListener("lib:asyncsink",(function(){return i(void 0,void 0,void 0,(function(){var t,e,n;return r(this,(function(i){switch(i.label){case 0:return ModAPI.addEventListener("custom:asyncsink_reloaded",(function(){ModAPI.mc.renderItem.registerItem(c,ModAPI.util.str("pistol")),ModAPI.mc.renderItem.registerItem(l,ModAPI.util.str("assaultrifle"))})),AsyncSink.L10N.set("item.pistol.name","Pistol"),AsyncSink.L10N.set("item.assaultrifle.name","Assault Rifle"),AsyncSink.setFile("resourcepacks/AsyncSinkLib/assets/minecraft/models/item/pistol.json",JSON.stringify({parent:"builtin/generated",textures:{layer0:"items/pistol"},display:{thirdperson:{rotation:[5,80,-45],translation:[0,1,-3],scale:[1,1,1]},firstperson:{rotation:[0,-135,25],translation:[0,4,2],scale:[1.8,1.8,1.8]}}})),e=(t=AsyncSink).setFile,n=["resourcepacks/AsyncSinkLib/assets/minecraft/textures/items/pistol.png"],[4,fetch(s)];case 1:return[4,i.sent().arrayBuffer()];case 2:return e.apply(t,n.concat([i.sent()])),[2]}}))}))}))}},e={};!function n(i){var r=e[i];if(void 0!==r)return r.exports;var o=e[i]={exports:{}};return t[i].call(o.exports,o,o.exports,n),o.exports}("./src/main.ts")})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZG9udXRzZ3Vucy5qcyIsIm1hcHBpbmdzIjoiOytEQUNBQSxPQUFPQyxlQUFlQyxFQUFTLGFBQWMsQ0FBRUMsT0FBTyxJQUN0REQsRUFBQSxRQUNBLFdBQ0ksSUFBSUUsRUFBYyxFQUNkQyxFQUFvQkMsT0FBT0MsUUFBUUMsZUFBZSxnQkFDbERDLEVBQWtCSCxPQUFPQyxRQUFRRyxhQUFhLDBDQUEwQ0MsZ0JBQWdCQyxRQUN4R0MsRUFBWVAsT0FBT0MsUUFBUUcsYUFBYSwyQkFDeENJLEVBQVlSLE9BQU9DLFFBQVFRLFNBQVNGLEdBQVcsU0FBVUcsR0FBSyxPQUFvQixJQUFiQSxFQUFFQyxNQUFjLElBQ3JGQyxFQUFtQixXQUNuQkosRUFBVUssTUFDVkEsS0FBS0MsZ0JBQWdCWCxFQUN6QixFQUNBSCxPQUFPZSxpQkFBaUIsVUFBVSxXQUM5QmYsT0FBT2dCLE9BQU9DLGVBQWlCbkIsRUFDL0JBLEdBQWUsRUFDbkIsSUF1Q0FFLE9BQU9DLFFBQVFpQixlQUFlWCxFQUFXSyxHQUN6QyxJQUFJTyxHQUFVLEVBd0NkLFNBQVNDLElBQ0wsSUFBSUMsR0FBVSxJQUFLVCxHQUFvQlUsb0JBQW9CdEIsT0FBT3VCLEtBQUtDLElBQUksaUJBQWlCQyxpQkFBaUIsR0FHN0csT0FGQWxCLEVBQVVtQixjQUFjQyxhQUFhQyxPQUFPNUIsT0FBTzZCLE9BQU9DLEtBQUssZ0JBQWlCOUIsT0FBT3VCLEtBQUtDLElBQUksZ0JBQWlCSCxHQUNqSHJCLE9BQU8rQixNQUFvQixhQUFJVixFQUN4QkEsQ0FDWCxDQUNBLEdBN0NBVCxFQUFpQm9CLFVBQVVDLHNCQUF3QixTQUFVQyxHQUN6RGYsR0FBVSxDQUNkLEVBQ0FQLEVBQWlCb0IsVUFBVUcsaUJBQW1CLFNBQVVELEdBQ3BELE9BQU9BLENBQ1gsRUFDQXRCLEVBQWlCb0IsVUFBVUksdUJBQXlCLFNBQVVGLEdBQzFELE9BQU8sSUFDWCxFQUNBdEIsRUFBaUJvQixVQUFVSyxrQkFBb0IsU0FBVUgsR0FFckQsT0FBT2xDLE9BQU9DLFFBQVFDLGVBQWUsY0FBY0csZ0JBQWdCaUMsS0FDdkUsRUFDQTFCLEVBQWlCb0IsVUFBVU8sa0JBQW9CLFNBQVVMLEVBQVlNLEVBQVFDLEdBQ3pFLElBQUt0QixFQUFTLENBQ1ZBLEdBQVUsRUFDVixJQUFJdUIsRUFBUzNDLEVBQWtCTSxnQkFBZ0JxQyxPQUMzQ0MsRUFBUTNDLE9BQU91QixLQUFLcUIsS0FBS0osR0FDekJLLEVBQWU3QyxPQUFPdUIsS0FBS3FCLEtBQUtILEdBQ2hDSyxFQTNEWixTQUF1QjlCLEVBQVEyQixHQVUzQixJQVRBLElBQ0lJLEVBQWMvQixFQUFPZ0MsZ0JBQWdCLEdBQ3JDQyxFQUFpQmpDLEVBQU9rQyxTQXdEZ0MsR0F4RGhCLEdBQUdDLE9BQzNDQyxFQUFXVCxFQUFNVSxxQ0FBcUNyQyxFQUFPc0MsU0FBVXRDLEVBQU91Qyx1QkFBdUJDLE9BdUQ3QyxVQXZEeUVGLFVBQVVHLGdCQUFnQkMsTUFDM0pDLEVBQWdCLEtBQ2hCQyxHQUFhLEVBQ2JDLEVBQWdCLEVBQ2hCQyxFQW1Ed0QsR0FqRG5EQyxFQUFJLEVBQUdBLEVBQUlYLEVBQVN6QyxPQUFRb0QsSUFDakMsR0FBS1gsRUFBU1csR0FBZCxDQUdBLElBQUlDLEVBQVNaLEVBQVNXLEdBR2xCRSxFQURXRCxFQUFPVCx1QkFBdUJDLE9BQU8sR0FBSyxHQUFLLElBQ3JDVSxtQkFBbUJuQixFQUFZTyxTQUFVTCxFQUFlSyxVQUNqRixHQUFpQixNQUFiVyxFQUFtQixDQUNuQixJQUFJRSxFQUFXcEIsRUFBWXFCLFdBQVdILEVBQVVkLE9BQU9HLFVBQ25EYSxFQUFXTCxJQUNYQSxFQUFrQkssRUFDbEJSLEVBQWdCSyxHQUNoQkosRUFBYUksRUFBT2hCLGdCQUFnQixHQUFLb0IsV0FBV0gsRUFBVWQsT0FBT0csVUF0QjNDLE9Bd0J0Qk8sRUFBZ0IsR0FHNUIsQ0FmQSxDQWtCSixPQUFzQixNQURERixFQUVWLENBQUVLLE9BRlFMLEVBRWdCVSxTQUFVVCxFQUFZVSxZQUFhVCxHQUc3RCxJQUVmLENBc0I2QlUsQ0FBYzFCLEVBQWNGLEdBQ2pERSxFQUFhMkIsYUFBYXRDLEVBQVl0QixFQUFpQm9CLFVBQVVJLHVCQUF1QkYsSUFDbEUsTUFBbEJZLEVBQ0lILEVBQU04QixTQUNOM0UsR0FBZSxHQUdmZ0QsRUFBZWtCLE9BQU9VLGlCQUFpQmhDLEVBQVEsR0FBTSxHQUFLSSxFQUFld0IsYUFDckV4QixFQUFldUIsVUFDZk0sUUFBUUMsSUFBSSxtQkFFaEJqQyxFQUFNa0Msa0JBQWtCaEMsRUFBYVMsU0FBVXRELE9BQU91QixLQUFLQyxJQUFJLG1CQUFvQixFQUFLLE1BR3RGbUIsRUFBTThCLFVBQ1o5QixFQUFNa0Msa0JBQWtCaEMsRUFBYVMsU0FBVXRELE9BQU91QixLQUFLQyxJQUFJLGdCQUFpQixFQUFLLElBRTdGLENBQ0EsT0FBT1UsQ0FDWCxFQU9JbEMsT0FBTytCLE1BQ1AsT0FBT1gsSUFHUHBCLE9BQU9lLGlCQUFpQixZQUFhSyxFQUU3QyxrQ0MzR0ExQixPQUFPQyxlQUFlQyxFQUFTLGFBQWMsQ0FBRUMsT0FBTyxJQUN0REQsRUFBQSxRQUNBLFdBQ0ksSUFBSUUsRUFBYyxFQUNkQyxFQUFvQkMsT0FBT0MsUUFBUUMsZUFBZSxnQkFDbERDLEVBQWtCSCxPQUFPQyxRQUFRRyxhQUFhLDBDQUEwQ0MsZ0JBQWdCQyxRQUN4R0MsRUFBWVAsT0FBT0MsUUFBUUcsYUFBYSwyQkFDeENJLEVBQVlSLE9BQU9DLFFBQVFRLFNBQVNGLEdBQVcsU0FBVUcsR0FBSyxPQUFvQixJQUFiQSxFQUFFQyxNQUFjLElBQ3JGbUUsRUFBaUIsV0FDakJ0RSxFQUFVSyxNQUNWQSxLQUFLQyxnQkFBZ0JYLEVBQ3pCLEVBa0VBLFNBQVNpQixJQUNMLElBQUkyRCxHQUFjLElBQUtELEdBQWtCeEQsb0JBQW9CdEIsT0FBT3VCLEtBQUtDLElBQUksV0FBV0MsaUJBQWlCLEdBR3pHLE9BRkFsQixFQUFVbUIsY0FBY0MsYUFBYUMsT0FBTzVCLE9BQU82QixPQUFPQyxLQUFLLFVBQVc5QixPQUFPdUIsS0FBS0MsSUFBSSxVQUFXdUQsR0FDckcvRSxPQUFPK0IsTUFBYyxPQUFJZ0QsRUFDbEJBLENBQ1gsQ0FDQSxHQXZFQS9FLE9BQU9lLGlCQUFpQixVQUFVLFdBQzlCZixPQUFPZ0IsT0FBT0MsZUFBaUJuQixFQUMvQkEsR0FBZSxFQUNuQixJQXVDQUUsT0FBT0MsUUFBUWlCLGVBQWVYLEVBQVd1RSxHQUN6Q0EsRUFBZTlDLFVBQVVPLGtCQUFvQixTQUFVTCxFQUFZTSxFQUFRQyxHQUN2RSxJQUFJQyxFQUFTM0MsRUFBa0JNLGdCQUFnQnFDLE9BQzNDQyxFQUFRM0MsT0FBT3VCLEtBQUtxQixLQUFLSixHQUN6QkssRUFBZTdDLE9BQU91QixLQUFLcUIsS0FBS0gsR0FDaENLLEVBM0NSLFNBQXVCOUIsRUFBUTJCLEdBVTNCLElBVEEsSUFDSUksRUFBYy9CLEVBQU9nQyxnQkFBZ0IsR0FDckNDLEVBQWlCakMsRUFBT2tDLFNBd0M0QixHQXhDWixHQUFHQyxPQUMzQ0MsRUFBV1QsRUFBTVUscUNBQXFDckMsRUFBT3NDLFNBQVV0QyxFQUFPdUMsdUJBQXVCQyxPQXVDakQsVUF2QzZFRixVQUFVRyxnQkFBZ0JDLE1BQzNKQyxFQUFnQixLQUNoQkMsR0FBYSxFQUNiQyxFQUFnQixFQUNoQkMsRUFtQ29ELEdBakMvQ0MsRUFBSSxFQUFHQSxFQUFJWCxFQUFTekMsT0FBUW9ELElBQ2pDLEdBQUtYLEVBQVNXLEdBQWQsQ0FHQSxJQUFJQyxFQUFTWixFQUFTVyxHQUdsQkUsRUFEV0QsRUFBT1QsdUJBQXVCQyxPQUFPLEdBQUssR0FBSyxJQUNyQ1UsbUJBQW1CbkIsRUFBWU8sU0FBVUwsRUFBZUssVUFDakYsR0FBaUIsTUFBYlcsRUFBbUIsQ0FDbkIsSUFBSUUsRUFBV3BCLEVBQVlxQixXQUFXSCxFQUFVZCxPQUFPRyxVQUNuRGEsRUFBV0wsSUFDWEEsRUFBa0JLLEVBQ2xCUixFQUFnQkssR0FDaEJKLEVBQWFJLEVBQU9oQixnQkFBZ0IsR0FBS29CLFdBQVdILEVBQVVkLE9BQU9HLFVBdEIzQyxPQXdCdEJPLEVBQWdCLEdBRzVCLENBZkEsQ0FrQkosT0FBc0IsTUFEREYsRUFFVixDQUFFSyxPQUZRTCxFQUVnQlUsU0FBVVQsRUFBWVUsWUFBYVQsR0FHN0QsSUFFZixDQU15QlUsQ0FBYzFCLEVBQWNGLEdBZ0JqRCxPQWZzQixNQUFsQkcsRUFDSUgsRUFBTThCLFNBQ04zRSxHQUFlLEdBR2ZnRCxFQUFla0IsT0FBT1UsaUJBQWlCaEMsRUFBUSxHQUFNLEdBQUtJLEVBQWV3QixhQUNyRXhCLEVBQWV1QixVQUNmTSxRQUFRQyxJQUFJLG1CQUVoQmpDLEVBQU1rQyxrQkFBa0JoQyxFQUFhUyxTQUFVdEQsT0FBT3VCLEtBQUtDLElBQUksbUJBQW9CLEVBQUssTUFHdEZtQixFQUFNOEIsVUFDWjlCLEVBQU1rQyxrQkFBa0JoQyxFQUFhUyxTQUFVdEQsT0FBT3VCLEtBQUtDLElBQUksZ0JBQWlCLEVBQUssS0FFbEZVLENBQ1gsRUFPSWxDLE9BQU8rQixNQUNQLE9BQU9YLElBR1BwQixPQUFPZSxpQkFBaUIsWUFBYUssRUFFN0MsbUNDekZBLElBQUk0RCxFQUFhbkUsTUFBUUEsS0FBS21FLFdBQWMsU0FBVUMsRUFBU0MsRUFBWUMsRUFBR0MsR0FFMUUsT0FBTyxJQUFLRCxJQUFNQSxFQUFJRSxXQUFVLFNBQVVDLEVBQVNDLEdBQy9DLFNBQVNDLEVBQVUzRixHQUFTLElBQU00RixFQUFLTCxFQUFVTSxLQUFLN0YsR0FBUyxDQUFFLE1BQU84RixHQUFLSixFQUFPSSxFQUFJLENBQUUsQ0FDMUYsU0FBU0MsRUFBUy9GLEdBQVMsSUFBTTRGLEVBQUtMLEVBQWlCLE1BQUV2RixHQUFTLENBQUUsTUFBTzhGLEdBQUtKLEVBQU9JLEVBQUksQ0FBRSxDQUM3RixTQUFTRixFQUFLSSxHQUpsQixJQUFlaEcsRUFJYWdHLEVBQU9DLEtBQU9SLEVBQVFPLEVBQU9oRyxRQUoxQ0EsRUFJeURnRyxFQUFPaEcsTUFKaERBLGFBQWlCc0YsRUFBSXRGLEVBQVEsSUFBSXNGLEdBQUUsU0FBVUcsR0FBV0EsRUFBUXpGLEVBQVEsS0FJakJrRyxLQUFLUCxFQUFXSSxFQUFXLENBQzdHSCxHQUFNTCxFQUFZQSxFQUFVWSxNQUFNZixFQUFTQyxHQUFjLEtBQUtRLE9BQ2xFLEdBQ0osRUFDSU8sRUFBZXBGLE1BQVFBLEtBQUtvRixhQUFnQixTQUFVaEIsRUFBU2lCLEdBQy9ELElBQXNHQyxFQUFHQyxFQUFHQyxFQUF4R0MsRUFBSSxDQUFFQyxNQUFPLEVBQUdDLEtBQU0sV0FBYSxHQUFXLEVBQVBILEVBQUUsR0FBUSxNQUFNQSxFQUFFLEdBQUksT0FBT0EsRUFBRSxFQUFJLEVBQUdJLEtBQU0sR0FBSUMsSUFBSyxJQUFlQyxFQUFJakgsT0FBT2tILFFBQTRCLG1CQUFiQyxTQUEwQkEsU0FBV25ILFFBQVFzQyxXQUN0TCxPQUFPMkUsRUFBRWpCLEtBQU9vQixFQUFLLEdBQUlILEVBQVMsTUFBSUcsRUFBSyxHQUFJSCxFQUFVLE9BQUlHLEVBQUssR0FBc0IsbUJBQVhDLFNBQTBCSixFQUFFSSxPQUFPQyxVQUFZLFdBQWEsT0FBT25HLElBQU0sR0FBSThGLEVBQzFKLFNBQVNHLEVBQUtHLEdBQUssT0FBTyxTQUFVQyxHQUFLLE9BQ3pDLFNBQWNDLEdBQ1YsR0FBSWhCLEVBQUcsTUFBTSxJQUFJaUIsVUFBVSxtQ0FDM0IsS0FBT1QsSUFBTUEsRUFBSSxFQUFHUSxFQUFHLEtBQU9iLEVBQUksSUFBS0EsT0FDbkMsR0FBSUgsRUFBSSxFQUFHQyxJQUFNQyxFQUFZLEVBQVJjLEVBQUcsR0FBU2YsRUFBVSxPQUFJZSxFQUFHLEdBQUtmLEVBQVMsU0FBT0MsRUFBSUQsRUFBVSxTQUFNQyxFQUFFZ0IsS0FBS2pCLEdBQUksR0FBS0EsRUFBRVYsU0FBV1csRUFBSUEsRUFBRWdCLEtBQUtqQixFQUFHZSxFQUFHLEtBQUtyQixLQUFNLE9BQU9PLEVBRTNKLE9BRElELEVBQUksRUFBR0MsSUFBR2MsRUFBSyxDQUFTLEVBQVJBLEVBQUcsR0FBUWQsRUFBRXhHLFFBQ3pCc0gsRUFBRyxJQUNQLEtBQUssRUFBRyxLQUFLLEVBQUdkLEVBQUljLEVBQUksTUFDeEIsS0FBSyxFQUFjLE9BQVhiLEVBQUVDLFFBQWdCLENBQUUxRyxNQUFPc0gsRUFBRyxHQUFJckIsTUFBTSxHQUNoRCxLQUFLLEVBQUdRLEVBQUVDLFFBQVNILEVBQUllLEVBQUcsR0FBSUEsRUFBSyxDQUFDLEdBQUksU0FDeEMsS0FBSyxFQUFHQSxFQUFLYixFQUFFSSxJQUFJWSxNQUFPaEIsRUFBRUcsS0FBS2EsTUFBTyxTQUN4QyxRQUNJLE1BQWtCakIsR0FBWkEsRUFBSUMsRUFBRUcsTUFBWTlGLE9BQVMsR0FBSzBGLEVBQUVBLEVBQUUxRixPQUFTLEtBQWtCLElBQVZ3RyxFQUFHLElBQXNCLElBQVZBLEVBQUcsSUFBVyxDQUFFYixFQUFJLEVBQUcsUUFBVSxDQUMzRyxHQUFjLElBQVZhLEVBQUcsTUFBY2QsR0FBTWMsRUFBRyxHQUFLZCxFQUFFLElBQU1jLEVBQUcsR0FBS2QsRUFBRSxJQUFNLENBQUVDLEVBQUVDLE1BQVFZLEVBQUcsR0FBSSxLQUFPLENBQ3JGLEdBQWMsSUFBVkEsRUFBRyxJQUFZYixFQUFFQyxNQUFRRixFQUFFLEdBQUksQ0FBRUMsRUFBRUMsTUFBUUYsRUFBRSxHQUFJQSxFQUFJYyxFQUFJLEtBQU8sQ0FDcEUsR0FBSWQsR0FBS0MsRUFBRUMsTUFBUUYsRUFBRSxHQUFJLENBQUVDLEVBQUVDLE1BQVFGLEVBQUUsR0FBSUMsRUFBRUksSUFBSWEsS0FBS0osR0FBSyxLQUFPLENBQzlEZCxFQUFFLElBQUlDLEVBQUVJLElBQUlZLE1BQ2hCaEIsRUFBRUcsS0FBS2EsTUFBTyxTQUV0QkgsRUFBS2pCLEVBQUttQixLQUFLcEMsRUFBU3FCLEVBQzVCLENBQUUsTUFBT1gsR0FBS3dCLEVBQUssQ0FBQyxFQUFHeEIsR0FBSVMsRUFBSSxDQUFHLENBQUUsUUFBVUQsRUFBSUUsRUFBSSxDQUFHLENBQ3pELEdBQVksRUFBUmMsRUFBRyxHQUFRLE1BQU1BLEVBQUcsR0FBSSxNQUFPLENBQUV0SCxNQUFPc0gsRUFBRyxHQUFLQSxFQUFHLFFBQUssRUFBUXJCLE1BQU0sRUFDOUUsQ0F0QmdETCxDQUFLLENBQUN3QixFQUFHQyxHQUFLLENBQUcsQ0F1QnJFLEVBQ0F4SCxPQUFPQyxlQUFlQyxFQUFTLGFBQWMsQ0FBRUMsT0FBTyxJQUN0RCxJQUFJMkgsRUFBVyxFQUFRLHdCQUNuQkMsRUFBaUIsRUFBUSw4QkFDekJDLEVBQWMsNmVBQ2xCMUgsT0FBTzJILEtBQUtDLE1BQU0sbUJBQ2xCNUgsT0FBTzJILEtBQUtFLFFBQVEsT0FDcEI3SCxPQUFPMkgsS0FBS0csS0FBS0osR0FDakIxSCxPQUFPMkgsS0FBS0ksWUFBWSw0REFDeEIvSCxPQUFPZ0ksZ0JBQWdCQyxXQUFXVCxFQUFTVSxTQUMzQ2xJLE9BQU9nSSxnQkFBZ0JDLFdBQVdSLEVBQWVTLFNBQ2pELElBQUluRCxHQUFjLEVBQUl5QyxFQUFTVSxXQUMzQjdHLEdBQVUsRUFBSW9HLEVBQWVTLFdBQ2pDbEksT0FBT2UsaUJBQWlCLGlCQUFpQixXQUFjLE9BQU9pRSxPQUFVLE9BQVEsT0FBUSxHQUFRLFdBQzVGLElBQUltRCxFQUFJQyxFQUFJQyxFQUNaLE9BQU9wQyxFQUFZcEYsTUFBTSxTQUFVeUgsR0FDL0IsT0FBUUEsRUFBRy9CLE9BQ1AsS0FBSyxFQTJCRCxPQTFCQXZHLE9BQU9lLGlCQUFpQiw2QkFBNkIsV0FDakRmLE9BQU91SSxHQUFHQyxXQUFXN0csYUFBYW9ELEVBQWEvRSxPQUFPdUIsS0FBS0MsSUFBSSxXQUMvRHhCLE9BQU91SSxHQUFHQyxXQUFXN0csYUFBYU4sRUFBU3JCLE9BQU91QixLQUFLQyxJQUFJLGdCQUMvRCxJQUNBaUgsVUFBVUMsS0FBS0MsSUFBSSxtQkFBb0IsVUFDdkNGLFVBQVVDLEtBQUtDLElBQUkseUJBQTBCLGlCQUM3Q0YsVUFBVUcsUUFBUSxzRUFBdUVDLEtBQUtDLFVBQVUsQ0FDcEcsT0FBVSxvQkFDVixTQUFZLENBQ1IsT0FBVSxnQkFFZCxRQUFXLENBQ1AsWUFBZSxDQUNYLFNBQVksQ0FBQyxFQUFHLElBQUssSUFDckIsWUFBZSxDQUFDLEVBQUcsR0FBSSxHQUN2QixNQUFTLENBQUMsRUFBSyxFQUFLLElBRXhCLFlBQWUsQ0FDWCxTQUFZLENBQUMsR0FBSSxJQUFLLElBQ3RCLFlBQWUsQ0FBQyxFQUFHLEVBQUcsR0FDdEIsTUFBUyxDQUFDLElBQUssSUFBSyxVQUloQ1YsR0FBTUQsRUFBS00sV0FBV0csUUFDdEJQLEVBQUssQ0FBQyx5RUFDQyxDQUFDLEVBQWFVLE1BQU1yQixJQUMvQixLQUFLLEVBQUcsTUFBTyxDQUFDLEVBQWNZLEVBQUc5QixPQUFRd0MsZUFDekMsS0FBSyxFQUVELE9BREFaLEVBQUdwQyxNQUFNbUMsRUFBSUUsRUFBR1ksT0FBTyxDQUFDWCxFQUFHOUIsVUFDcEIsQ0FBQyxHQUVwQixHQUNKLEdBQUksTUN0RkEwQyxFQUEyQixDQUFDLEdBR2hDLFNBQVNDLEVBQW9CQyxHQUU1QixJQUFJQyxFQUFlSCxFQUF5QkUsR0FDNUMsUUFBcUJFLElBQWpCRCxFQUNILE9BQU9BLEVBQWF6SixRQUdyQixJQUFJMkosRUFBU0wsRUFBeUJFLEdBQVksQ0FHakR4SixRQUFTLENBQUMsR0FPWCxPQUhBNEosRUFBb0JKLEdBQVUvQixLQUFLa0MsRUFBTzNKLFFBQVMySixFQUFRQSxFQUFPM0osUUFBU3VKLEdBR3BFSSxFQUFPM0osT0FDZixDQ25CMEJ1SixDQUFvQiIsInNvdXJjZXMiOlsid2VicGFjazovL2RvbnV0c2d1bnMvLi9zcmMvZ3Vucy9Bc3NhdWx0UmlmbGUudHMiLCJ3ZWJwYWNrOi8vZG9udXRzZ3Vucy8uL3NyYy9ndW5zL1Bpc3RvbC50cyIsIndlYnBhY2s6Ly9kb251dHNndW5zLy4vc3JjL21haW4udHMiLCJ3ZWJwYWNrOi8vZG9udXRzZ3Vucy93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly9kb251dHNndW5zL3dlYnBhY2svc3RhcnR1cCJdLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbmV4cG9ydHMuZGVmYXVsdCA9IEFzc2F1bHRSaWZsZTtcbmZ1bmN0aW9uIEFzc2F1bHRSaWZsZSgpIHtcbiAgICB2YXIgcmVjb2lsU3BlZWQgPSAxOyAvL3JlY29pbCBjb250cm9sbGVyXG4gICAgdmFyIERhbWFnZVNvdXJjZUNsYXNzID0gTW9kQVBJLnJlZmxlY3QuZ2V0Q2xhc3NCeU5hbWUoXCJEYW1hZ2VTb3VyY2VcIik7XG4gICAgdmFyIGNyZWF0aXZlTWlzY1RhYiA9IE1vZEFQSS5yZWZsZWN0LmdldENsYXNzQnlJZChcIm5ldC5taW5lY3JhZnQuY3JlYXRpdmV0YWIuQ3JlYXRpdmVUYWJzXCIpLnN0YXRpY1ZhcmlhYmxlcy50YWJNaXNjO1xuICAgIHZhciBpdGVtQ2xhc3MgPSBNb2RBUEkucmVmbGVjdC5nZXRDbGFzc0J5SWQoXCJuZXQubWluZWNyYWZ0Lml0ZW0uSXRlbVwiKTtcbiAgICB2YXIgaXRlbVN1cGVyID0gTW9kQVBJLnJlZmxlY3QuZ2V0U3VwZXIoaXRlbUNsYXNzLCBmdW5jdGlvbiAoeCkgeyByZXR1cm4geC5sZW5ndGggPT09IDE7IH0pO1xuICAgIHZhciBubWlfQXNzYXVsdFJpZmxlID0gZnVuY3Rpb24gbm1pX0Fzc2F1bHRSaWZsZSgpIHtcbiAgICAgICAgaXRlbVN1cGVyKHRoaXMpOyAvL1VzZSBzdXBlciBmdW5jdGlvbiB0byBnZXQgYmxvY2sgcHJvcGVydGllcyBvbiB0aGlzIGNsYXNzLlxuICAgICAgICB0aGlzLiRzZXRDcmVhdGl2ZVRhYihjcmVhdGl2ZU1pc2NUYWIpO1xuICAgIH07XG4gICAgTW9kQVBJLmFkZEV2ZW50TGlzdGVuZXIoXCJ1cGRhdGVcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgICBNb2RBUEkucGxheWVyLnJvdGF0aW9uUGl0Y2ggLT0gcmVjb2lsU3BlZWQ7XG4gICAgICAgIHJlY29pbFNwZWVkICo9IDAuNztcbiAgICB9KTtcbiAgICBmdW5jdGlvbiBlbnRpdHlSYXlDYXN0KHBsYXllciwgd29ybGQsIHJhbmdlKSB7XG4gICAgICAgIHZhciBIRUFEU0hPVF9NQVhfRElTVEFOQ0VfRlJPTV9IRUFEID0gMC43MjtcbiAgICAgICAgdmFyIGV5ZVBvc2l0aW9uID0gcGxheWVyLmdldFBvc2l0aW9uRXllcygwLjApO1xuICAgICAgICB2YXIgdGFyZ2V0UG9zaXRpb24gPSBwbGF5ZXIucmF5VHJhY2UocmFuZ2UsIDApLmhpdFZlYztcbiAgICAgICAgdmFyIGVudGl0aWVzID0gd29ybGQuZ2V0RW50aXRpZXNXaXRoaW5BQUJCRXhjbHVkaW5nRW50aXR5KHBsYXllci5nZXRSZWYoKSwgcGxheWVyLmdldEVudGl0eUJvdW5kaW5nQm94KCkuZXhwYW5kKHJhbmdlLCByYW5nZSwgcmFuZ2UpLmdldFJlZigpKS5nZXRDb3JyZWN0aXZlKCkuYXJyYXk7XG4gICAgICAgIHZhciBjbG9zZXN0RW50aXR5ID0gbnVsbDtcbiAgICAgICAgdmFyIGlzSGVhZHNob3QgPSBmYWxzZTtcbiAgICAgICAgdmFyIGlzSGVhZHNob3RJbnQgPSAwO1xuICAgICAgICB2YXIgY2xvc2VzdERpc3RhbmNlID0gcmFuZ2U7XG4gICAgICAgIC8vIEl0ZXJhdGUgdGhyb3VnaCBhbGwgZW50aXRpZXMgdG8gZmluZCB0aGUgb25lIHRoZSBwbGF5ZXIgaXMgbG9va2luZyBhdFxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGVudGl0aWVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBpZiAoIWVudGl0aWVzW2ldKSB7XG4gICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgZW50aXR5ID0gZW50aXRpZXNbaV07XG4gICAgICAgICAgICAvLyBDaGVjayBpZiB0aGUgZW50aXR5J3MgYm91bmRpbmcgYm94IGludGVyc2VjdHMgd2l0aCB0aGUgcGxheWVyJ3MgcmF5XG4gICAgICAgICAgICB2YXIgZW50aXR5QkIgPSBlbnRpdHkuZ2V0RW50aXR5Qm91bmRpbmdCb3goKS5leHBhbmQoMC4zLCAwLjMsIDAuMyk7XG4gICAgICAgICAgICB2YXIgaW50ZXJjZXB0ID0gZW50aXR5QkIuY2FsY3VsYXRlSW50ZXJjZXB0KGV5ZVBvc2l0aW9uLmdldFJlZigpLCB0YXJnZXRQb3NpdGlvbi5nZXRSZWYoKSk7XG4gICAgICAgICAgICBpZiAoaW50ZXJjZXB0ICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICB2YXIgZGlzdGFuY2UgPSBleWVQb3NpdGlvbi5kaXN0YW5jZVRvKGludGVyY2VwdC5oaXRWZWMuZ2V0UmVmKCkpO1xuICAgICAgICAgICAgICAgIGlmIChkaXN0YW5jZSA8IGNsb3Nlc3REaXN0YW5jZSkge1xuICAgICAgICAgICAgICAgICAgICBjbG9zZXN0RGlzdGFuY2UgPSBkaXN0YW5jZTtcbiAgICAgICAgICAgICAgICAgICAgY2xvc2VzdEVudGl0eSA9IGVudGl0eTtcbiAgICAgICAgICAgICAgICAgICAgaXNIZWFkc2hvdCA9IGVudGl0eS5nZXRQb3NpdGlvbkV5ZXMoMC4wKS5kaXN0YW5jZVRvKGludGVyY2VwdC5oaXRWZWMuZ2V0UmVmKCkpIDwgSEVBRFNIT1RfTUFYX0RJU1RBTkNFX0ZST01fSEVBRDtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGlzSGVhZHNob3QpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlzSGVhZHNob3RJbnQgPSAxO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHZhciByYXlUcmFjZVJlc3VsdCA9IGNsb3Nlc3RFbnRpdHk7XG4gICAgICAgIGlmIChyYXlUcmFjZVJlc3VsdCAhPSBudWxsKSB7XG4gICAgICAgICAgICByZXR1cm4geyBlbnRpdHk6IHJheVRyYWNlUmVzdWx0LCBoZWFkc2hvdDogaXNIZWFkc2hvdCwgaW50aGVhZHNob3Q6IGlzSGVhZHNob3RJbnQgfTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgfVxuICAgIE1vZEFQSS5yZWZsZWN0LnByb3RvdHlwZVN0YWNrKGl0ZW1DbGFzcywgbm1pX0Fzc2F1bHRSaWZsZSk7XG4gICAgdmFyIGhhc1Nob3QgPSBmYWxzZTtcbiAgICBubWlfQXNzYXVsdFJpZmxlLnByb3RvdHlwZS4kb25QbGF5ZXJTdG9wcGVkVXNpbmcgPSBmdW5jdGlvbiAoJGl0ZW1zdGFjaykge1xuICAgICAgICBoYXNTaG90ID0gZmFsc2U7XG4gICAgfTtcbiAgICBubWlfQXNzYXVsdFJpZmxlLnByb3RvdHlwZS4kb25JdGVtVXNlRmluaXNoID0gZnVuY3Rpb24gKCRpdGVtc3RhY2spIHtcbiAgICAgICAgcmV0dXJuICRpdGVtc3RhY2s7XG4gICAgfTtcbiAgICBubWlfQXNzYXVsdFJpZmxlLnByb3RvdHlwZS4kZ2V0TWF4SXRlbVVzZUR1cmF0aW9uID0gZnVuY3Rpb24gKCRpdGVtc3RhY2spIHtcbiAgICAgICAgcmV0dXJuIDcyMDAwO1xuICAgIH07XG4gICAgbm1pX0Fzc2F1bHRSaWZsZS5wcm90b3R5cGUuJGdldEl0ZW1Vc2VBY3Rpb24gPSBmdW5jdGlvbiAoJGl0ZW1zdGFjaykge1xuICAgICAgICAvL2lsbCBhZGQgYW4gZW51bSBmb3IgR1VOIGxhdGVyXG4gICAgICAgIHJldHVybiBNb2RBUEkucmVmbGVjdC5nZXRDbGFzc0J5TmFtZShcIkVudW1BY3Rpb25cIikuc3RhdGljVmFyaWFibGVzLkRSSU5LO1xuICAgIH07XG4gICAgbm1pX0Fzc2F1bHRSaWZsZS5wcm90b3R5cGUuJG9uSXRlbVJpZ2h0Q2xpY2sgPSBmdW5jdGlvbiAoJGl0ZW1zdGFjaywgJHdvcmxkLCAkcGxheWVyKSB7XG4gICAgICAgIGlmICghaGFzU2hvdCkge1xuICAgICAgICAgICAgaGFzU2hvdCA9IHRydWU7XG4gICAgICAgICAgICB2YXIgY2FjdHVzID0gRGFtYWdlU291cmNlQ2xhc3Muc3RhdGljVmFyaWFibGVzLmNhY3R1cztcbiAgICAgICAgICAgIHZhciB3b3JsZCA9IE1vZEFQSS51dGlsLndyYXAoJHdvcmxkKTtcbiAgICAgICAgICAgIHZhciBlbnRpdHlwbGF5ZXIgPSBNb2RBUEkudXRpbC53cmFwKCRwbGF5ZXIpO1xuICAgICAgICAgICAgdmFyIHNob3RlbnRpdHlkYXRhID0gZW50aXR5UmF5Q2FzdChlbnRpdHlwbGF5ZXIsIHdvcmxkLCAzMi4wKTtcbiAgICAgICAgICAgIGVudGl0eXBsYXllci5zZXRJdGVtSW5Vc2UoJGl0ZW1zdGFjaywgbm1pX0Fzc2F1bHRSaWZsZS5wcm90b3R5cGUuJGdldE1heEl0ZW1Vc2VEdXJhdGlvbigkaXRlbXN0YWNrKSk7XG4gICAgICAgICAgICBpZiAoc2hvdGVudGl0eWRhdGEgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIGlmICh3b3JsZC5pc1JlbW90ZSkge1xuICAgICAgICAgICAgICAgICAgICByZWNvaWxTcGVlZCArPSA0O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgc2hvdGVudGl0eWRhdGEuZW50aXR5LmF0dGFja0VudGl0eUZyb20oY2FjdHVzLCAxMCArICgxNiAqIHNob3RlbnRpdHlkYXRhLmludGhlYWRzaG90KSk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzaG90ZW50aXR5ZGF0YS5oZWFkc2hvdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJIIEUgQSBEIFMgSCBPIFRcIik7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgd29ybGQucGxheVNvdW5kQXRFbnRpdHkoZW50aXR5cGxheWVyLmdldFJlZigpLCBNb2RBUEkudXRpbC5zdHIoXCJ0aWxlLnBpc3Rvbi5vdXRcIiksIDEuMCwgMS44KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmICghd29ybGQuaXNSZW1vdGUpIHtcbiAgICAgICAgICAgICAgICB3b3JsZC5wbGF5U291bmRBdEVudGl0eShlbnRpdHlwbGF5ZXIuZ2V0UmVmKCksIE1vZEFQSS51dGlsLnN0cihcInJhbmRvbS5jbGlja1wiKSwgMS4wLCAxLjgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiAkaXRlbXN0YWNrO1xuICAgIH07XG4gICAgZnVuY3Rpb24gaW50ZXJuYWxfcmVnKCkge1xuICAgICAgICB2YXIgYXJfaXRlbSA9IChuZXcgbm1pX0Fzc2F1bHRSaWZsZSgpKS4kc2V0VW5sb2NhbGl6ZWROYW1lKE1vZEFQSS51dGlsLnN0cihcImFzc2F1bHRyaWZsZVwiKSkuJHNldE1heFN0YWNrU2l6ZSgxKTtcbiAgICAgICAgaXRlbUNsYXNzLnN0YXRpY01ldGhvZHMucmVnaXN0ZXJJdGVtLm1ldGhvZChNb2RBUEkua2V5Z2VuLml0ZW0oXCJhc3NhdWx0cmlmbGVcIiksIE1vZEFQSS51dGlsLnN0cihcImFzc2F1bHRyaWZsZVwiKSwgYXJfaXRlbSk7XG4gICAgICAgIE1vZEFQSS5pdGVtc1tcImFzc2F1bHRyaWZsZVwiXSA9IGFyX2l0ZW07XG4gICAgICAgIHJldHVybiBhcl9pdGVtO1xuICAgIH1cbiAgICBpZiAoTW9kQVBJLml0ZW1zKSB7XG4gICAgICAgIHJldHVybiBpbnRlcm5hbF9yZWcoKTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIE1vZEFQSS5hZGRFdmVudExpc3RlbmVyKFwiYm9vdHN0cmFwXCIsIGludGVybmFsX3JlZyk7XG4gICAgfVxufVxuIiwiXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG5leHBvcnRzLmRlZmF1bHQgPSBQaXN0b2xJdGVtO1xuZnVuY3Rpb24gUGlzdG9sSXRlbSgpIHtcbiAgICB2YXIgcmVjb2lsU3BlZWQgPSAxOyAvL3JlY29pbCBjb250cm9sbGVyXG4gICAgdmFyIERhbWFnZVNvdXJjZUNsYXNzID0gTW9kQVBJLnJlZmxlY3QuZ2V0Q2xhc3NCeU5hbWUoXCJEYW1hZ2VTb3VyY2VcIik7XG4gICAgdmFyIGNyZWF0aXZlTWlzY1RhYiA9IE1vZEFQSS5yZWZsZWN0LmdldENsYXNzQnlJZChcIm5ldC5taW5lY3JhZnQuY3JlYXRpdmV0YWIuQ3JlYXRpdmVUYWJzXCIpLnN0YXRpY1ZhcmlhYmxlcy50YWJNaXNjO1xuICAgIHZhciBpdGVtQ2xhc3MgPSBNb2RBUEkucmVmbGVjdC5nZXRDbGFzc0J5SWQoXCJuZXQubWluZWNyYWZ0Lml0ZW0uSXRlbVwiKTtcbiAgICB2YXIgaXRlbVN1cGVyID0gTW9kQVBJLnJlZmxlY3QuZ2V0U3VwZXIoaXRlbUNsYXNzLCBmdW5jdGlvbiAoeCkgeyByZXR1cm4geC5sZW5ndGggPT09IDE7IH0pO1xuICAgIHZhciBubWlfSXRlbVBpc3RvbCA9IGZ1bmN0aW9uIG5taV9JdGVtUGlzdG9sKCkge1xuICAgICAgICBpdGVtU3VwZXIodGhpcyk7IC8vVXNlIHN1cGVyIGZ1bmN0aW9uIHRvIGdldCBibG9jayBwcm9wZXJ0aWVzIG9uIHRoaXMgY2xhc3MuXG4gICAgICAgIHRoaXMuJHNldENyZWF0aXZlVGFiKGNyZWF0aXZlTWlzY1RhYik7XG4gICAgfTtcbiAgICBNb2RBUEkuYWRkRXZlbnRMaXN0ZW5lcihcInVwZGF0ZVwiLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIE1vZEFQSS5wbGF5ZXIucm90YXRpb25QaXRjaCAtPSByZWNvaWxTcGVlZDtcbiAgICAgICAgcmVjb2lsU3BlZWQgKj0gMC43O1xuICAgIH0pO1xuICAgIGZ1bmN0aW9uIGVudGl0eVJheUNhc3QocGxheWVyLCB3b3JsZCwgcmFuZ2UpIHtcbiAgICAgICAgdmFyIEhFQURTSE9UX01BWF9ESVNUQU5DRV9GUk9NX0hFQUQgPSAwLjcyO1xuICAgICAgICB2YXIgZXllUG9zaXRpb24gPSBwbGF5ZXIuZ2V0UG9zaXRpb25FeWVzKDAuMCk7XG4gICAgICAgIHZhciB0YXJnZXRQb3NpdGlvbiA9IHBsYXllci5yYXlUcmFjZShyYW5nZSwgMCkuaGl0VmVjO1xuICAgICAgICB2YXIgZW50aXRpZXMgPSB3b3JsZC5nZXRFbnRpdGllc1dpdGhpbkFBQkJFeGNsdWRpbmdFbnRpdHkocGxheWVyLmdldFJlZigpLCBwbGF5ZXIuZ2V0RW50aXR5Qm91bmRpbmdCb3goKS5leHBhbmQocmFuZ2UsIHJhbmdlLCByYW5nZSkuZ2V0UmVmKCkpLmdldENvcnJlY3RpdmUoKS5hcnJheTtcbiAgICAgICAgdmFyIGNsb3Nlc3RFbnRpdHkgPSBudWxsO1xuICAgICAgICB2YXIgaXNIZWFkc2hvdCA9IGZhbHNlO1xuICAgICAgICB2YXIgaXNIZWFkc2hvdEludCA9IDA7XG4gICAgICAgIHZhciBjbG9zZXN0RGlzdGFuY2UgPSByYW5nZTtcbiAgICAgICAgLy8gSXRlcmF0ZSB0aHJvdWdoIGFsbCBlbnRpdGllcyB0byBmaW5kIHRoZSBvbmUgdGhlIHBsYXllciBpcyBsb29raW5nIGF0XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZW50aXRpZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGlmICghZW50aXRpZXNbaV0pIHtcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBlbnRpdHkgPSBlbnRpdGllc1tpXTtcbiAgICAgICAgICAgIC8vIENoZWNrIGlmIHRoZSBlbnRpdHkncyBib3VuZGluZyBib3ggaW50ZXJzZWN0cyB3aXRoIHRoZSBwbGF5ZXIncyByYXlcbiAgICAgICAgICAgIHZhciBlbnRpdHlCQiA9IGVudGl0eS5nZXRFbnRpdHlCb3VuZGluZ0JveCgpLmV4cGFuZCgwLjMsIDAuMywgMC4zKTtcbiAgICAgICAgICAgIHZhciBpbnRlcmNlcHQgPSBlbnRpdHlCQi5jYWxjdWxhdGVJbnRlcmNlcHQoZXllUG9zaXRpb24uZ2V0UmVmKCksIHRhcmdldFBvc2l0aW9uLmdldFJlZigpKTtcbiAgICAgICAgICAgIGlmIChpbnRlcmNlcHQgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIHZhciBkaXN0YW5jZSA9IGV5ZVBvc2l0aW9uLmRpc3RhbmNlVG8oaW50ZXJjZXB0LmhpdFZlYy5nZXRSZWYoKSk7XG4gICAgICAgICAgICAgICAgaWYgKGRpc3RhbmNlIDwgY2xvc2VzdERpc3RhbmNlKSB7XG4gICAgICAgICAgICAgICAgICAgIGNsb3Nlc3REaXN0YW5jZSA9IGRpc3RhbmNlO1xuICAgICAgICAgICAgICAgICAgICBjbG9zZXN0RW50aXR5ID0gZW50aXR5O1xuICAgICAgICAgICAgICAgICAgICBpc0hlYWRzaG90ID0gZW50aXR5LmdldFBvc2l0aW9uRXllcygwLjApLmRpc3RhbmNlVG8oaW50ZXJjZXB0LmhpdFZlYy5nZXRSZWYoKSkgPCBIRUFEU0hPVF9NQVhfRElTVEFOQ0VfRlJPTV9IRUFEO1xuICAgICAgICAgICAgICAgICAgICBpZiAoaXNIZWFkc2hvdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaXNIZWFkc2hvdEludCA9IDE7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHJheVRyYWNlUmVzdWx0ID0gY2xvc2VzdEVudGl0eTtcbiAgICAgICAgaWYgKHJheVRyYWNlUmVzdWx0ICE9IG51bGwpIHtcbiAgICAgICAgICAgIHJldHVybiB7IGVudGl0eTogcmF5VHJhY2VSZXN1bHQsIGhlYWRzaG90OiBpc0hlYWRzaG90LCBpbnRoZWFkc2hvdDogaXNIZWFkc2hvdEludCB9O1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICB9XG4gICAgTW9kQVBJLnJlZmxlY3QucHJvdG90eXBlU3RhY2soaXRlbUNsYXNzLCBubWlfSXRlbVBpc3RvbCk7XG4gICAgbm1pX0l0ZW1QaXN0b2wucHJvdG90eXBlLiRvbkl0ZW1SaWdodENsaWNrID0gZnVuY3Rpb24gKCRpdGVtc3RhY2ssICR3b3JsZCwgJHBsYXllcikge1xuICAgICAgICB2YXIgY2FjdHVzID0gRGFtYWdlU291cmNlQ2xhc3Muc3RhdGljVmFyaWFibGVzLmNhY3R1cztcbiAgICAgICAgdmFyIHdvcmxkID0gTW9kQVBJLnV0aWwud3JhcCgkd29ybGQpO1xuICAgICAgICB2YXIgZW50aXR5cGxheWVyID0gTW9kQVBJLnV0aWwud3JhcCgkcGxheWVyKTtcbiAgICAgICAgdmFyIHNob3RlbnRpdHlkYXRhID0gZW50aXR5UmF5Q2FzdChlbnRpdHlwbGF5ZXIsIHdvcmxkLCAxNi4wKTtcbiAgICAgICAgaWYgKHNob3RlbnRpdHlkYXRhICE9IG51bGwpIHtcbiAgICAgICAgICAgIGlmICh3b3JsZC5pc1JlbW90ZSkge1xuICAgICAgICAgICAgICAgIHJlY29pbFNwZWVkICs9IDQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBzaG90ZW50aXR5ZGF0YS5lbnRpdHkuYXR0YWNrRW50aXR5RnJvbShjYWN0dXMsIDEwICsgKDE2ICogc2hvdGVudGl0eWRhdGEuaW50aGVhZHNob3QpKTtcbiAgICAgICAgICAgICAgICBpZiAoc2hvdGVudGl0eWRhdGEuaGVhZHNob3QpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJIIEUgQSBEIFMgSCBPIFRcIik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHdvcmxkLnBsYXlTb3VuZEF0RW50aXR5KGVudGl0eXBsYXllci5nZXRSZWYoKSwgTW9kQVBJLnV0aWwuc3RyKFwidGlsZS5waXN0b24ub3V0XCIpLCAxLjAsIDEuOCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoIXdvcmxkLmlzUmVtb3RlKSB7XG4gICAgICAgICAgICB3b3JsZC5wbGF5U291bmRBdEVudGl0eShlbnRpdHlwbGF5ZXIuZ2V0UmVmKCksIE1vZEFQSS51dGlsLnN0cihcInJhbmRvbS5jbGlja1wiKSwgMS4wLCAxLjgpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAkaXRlbXN0YWNrO1xuICAgIH07XG4gICAgZnVuY3Rpb24gaW50ZXJuYWxfcmVnKCkge1xuICAgICAgICB2YXIgcGlzdG9sX2l0ZW0gPSAobmV3IG5taV9JdGVtUGlzdG9sKCkpLiRzZXRVbmxvY2FsaXplZE5hbWUoTW9kQVBJLnV0aWwuc3RyKFwicGlzdG9sXCIpKS4kc2V0TWF4U3RhY2tTaXplKDEpO1xuICAgICAgICBpdGVtQ2xhc3Muc3RhdGljTWV0aG9kcy5yZWdpc3Rlckl0ZW0ubWV0aG9kKE1vZEFQSS5rZXlnZW4uaXRlbShcInBpc3RvbFwiKSwgTW9kQVBJLnV0aWwuc3RyKFwicGlzdG9sXCIpLCBwaXN0b2xfaXRlbSk7XG4gICAgICAgIE1vZEFQSS5pdGVtc1tcInBpc3RvbFwiXSA9IHBpc3RvbF9pdGVtO1xuICAgICAgICByZXR1cm4gcGlzdG9sX2l0ZW07XG4gICAgfVxuICAgIGlmIChNb2RBUEkuaXRlbXMpIHtcbiAgICAgICAgcmV0dXJuIGludGVybmFsX3JlZygpO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgTW9kQVBJLmFkZEV2ZW50TGlzdGVuZXIoXCJib290c3RyYXBcIiwgaW50ZXJuYWxfcmVnKTtcbiAgICB9XG59XG4iLCJcInVzZSBzdHJpY3RcIjtcbnZhciBfX2F3YWl0ZXIgPSAodGhpcyAmJiB0aGlzLl9fYXdhaXRlcikgfHwgZnVuY3Rpb24gKHRoaXNBcmcsIF9hcmd1bWVudHMsIFAsIGdlbmVyYXRvcikge1xuICAgIGZ1bmN0aW9uIGFkb3B0KHZhbHVlKSB7IHJldHVybiB2YWx1ZSBpbnN0YW5jZW9mIFAgPyB2YWx1ZSA6IG5ldyBQKGZ1bmN0aW9uIChyZXNvbHZlKSB7IHJlc29sdmUodmFsdWUpOyB9KTsgfVxuICAgIHJldHVybiBuZXcgKFAgfHwgKFAgPSBQcm9taXNlKSkoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICBmdW5jdGlvbiBmdWxmaWxsZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3IubmV4dCh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XG4gICAgICAgIGZ1bmN0aW9uIHJlamVjdGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yW1widGhyb3dcIl0odmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxuICAgICAgICBmdW5jdGlvbiBzdGVwKHJlc3VsdCkgeyByZXN1bHQuZG9uZSA/IHJlc29sdmUocmVzdWx0LnZhbHVlKSA6IGFkb3B0KHJlc3VsdC52YWx1ZSkudGhlbihmdWxmaWxsZWQsIHJlamVjdGVkKTsgfVxuICAgICAgICBzdGVwKChnZW5lcmF0b3IgPSBnZW5lcmF0b3IuYXBwbHkodGhpc0FyZywgX2FyZ3VtZW50cyB8fCBbXSkpLm5leHQoKSk7XG4gICAgfSk7XG59O1xudmFyIF9fZ2VuZXJhdG9yID0gKHRoaXMgJiYgdGhpcy5fX2dlbmVyYXRvcikgfHwgZnVuY3Rpb24gKHRoaXNBcmcsIGJvZHkpIHtcbiAgICB2YXIgXyA9IHsgbGFiZWw6IDAsIHNlbnQ6IGZ1bmN0aW9uKCkgeyBpZiAodFswXSAmIDEpIHRocm93IHRbMV07IHJldHVybiB0WzFdOyB9LCB0cnlzOiBbXSwgb3BzOiBbXSB9LCBmLCB5LCB0LCBnID0gT2JqZWN0LmNyZWF0ZSgodHlwZW9mIEl0ZXJhdG9yID09PSBcImZ1bmN0aW9uXCIgPyBJdGVyYXRvciA6IE9iamVjdCkucHJvdG90eXBlKTtcbiAgICByZXR1cm4gZy5uZXh0ID0gdmVyYigwKSwgZ1tcInRocm93XCJdID0gdmVyYigxKSwgZ1tcInJldHVyblwiXSA9IHZlcmIoMiksIHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiAoZ1tTeW1ib2wuaXRlcmF0b3JdID0gZnVuY3Rpb24oKSB7IHJldHVybiB0aGlzOyB9KSwgZztcbiAgICBmdW5jdGlvbiB2ZXJiKG4pIHsgcmV0dXJuIGZ1bmN0aW9uICh2KSB7IHJldHVybiBzdGVwKFtuLCB2XSk7IH07IH1cbiAgICBmdW5jdGlvbiBzdGVwKG9wKSB7XG4gICAgICAgIGlmIChmKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiR2VuZXJhdG9yIGlzIGFscmVhZHkgZXhlY3V0aW5nLlwiKTtcbiAgICAgICAgd2hpbGUgKGcgJiYgKGcgPSAwLCBvcFswXSAmJiAoXyA9IDApKSwgXykgdHJ5IHtcbiAgICAgICAgICAgIGlmIChmID0gMSwgeSAmJiAodCA9IG9wWzBdICYgMiA/IHlbXCJyZXR1cm5cIl0gOiBvcFswXSA/IHlbXCJ0aHJvd1wiXSB8fCAoKHQgPSB5W1wicmV0dXJuXCJdKSAmJiB0LmNhbGwoeSksIDApIDogeS5uZXh0KSAmJiAhKHQgPSB0LmNhbGwoeSwgb3BbMV0pKS5kb25lKSByZXR1cm4gdDtcbiAgICAgICAgICAgIGlmICh5ID0gMCwgdCkgb3AgPSBbb3BbMF0gJiAyLCB0LnZhbHVlXTtcbiAgICAgICAgICAgIHN3aXRjaCAob3BbMF0pIHtcbiAgICAgICAgICAgICAgICBjYXNlIDA6IGNhc2UgMTogdCA9IG9wOyBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIDQ6IF8ubGFiZWwrKzsgcmV0dXJuIHsgdmFsdWU6IG9wWzFdLCBkb25lOiBmYWxzZSB9O1xuICAgICAgICAgICAgICAgIGNhc2UgNTogXy5sYWJlbCsrOyB5ID0gb3BbMV07IG9wID0gWzBdOyBjb250aW51ZTtcbiAgICAgICAgICAgICAgICBjYXNlIDc6IG9wID0gXy5vcHMucG9wKCk7IF8udHJ5cy5wb3AoKTsgY29udGludWU7XG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgaWYgKCEodCA9IF8udHJ5cywgdCA9IHQubGVuZ3RoID4gMCAmJiB0W3QubGVuZ3RoIC0gMV0pICYmIChvcFswXSA9PT0gNiB8fCBvcFswXSA9PT0gMikpIHsgXyA9IDA7IGNvbnRpbnVlOyB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChvcFswXSA9PT0gMyAmJiAoIXQgfHwgKG9wWzFdID4gdFswXSAmJiBvcFsxXSA8IHRbM10pKSkgeyBfLmxhYmVsID0gb3BbMV07IGJyZWFrOyB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChvcFswXSA9PT0gNiAmJiBfLmxhYmVsIDwgdFsxXSkgeyBfLmxhYmVsID0gdFsxXTsgdCA9IG9wOyBicmVhazsgfVxuICAgICAgICAgICAgICAgICAgICBpZiAodCAmJiBfLmxhYmVsIDwgdFsyXSkgeyBfLmxhYmVsID0gdFsyXTsgXy5vcHMucHVzaChvcCk7IGJyZWFrOyB9XG4gICAgICAgICAgICAgICAgICAgIGlmICh0WzJdKSBfLm9wcy5wb3AoKTtcbiAgICAgICAgICAgICAgICAgICAgXy50cnlzLnBvcCgpOyBjb250aW51ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG9wID0gYm9keS5jYWxsKHRoaXNBcmcsIF8pO1xuICAgICAgICB9IGNhdGNoIChlKSB7IG9wID0gWzYsIGVdOyB5ID0gMDsgfSBmaW5hbGx5IHsgZiA9IHQgPSAwOyB9XG4gICAgICAgIGlmIChvcFswXSAmIDUpIHRocm93IG9wWzFdOyByZXR1cm4geyB2YWx1ZTogb3BbMF0gPyBvcFsxXSA6IHZvaWQgMCwgZG9uZTogdHJ1ZSB9O1xuICAgIH1cbn07XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgUGlzdG9sXzEgPSByZXF1aXJlKFwiLi9ndW5zL1Bpc3RvbFwiKTtcbnZhciBBc3NhdWx0UmlmbGVfMSA9IHJlcXVpcmUoXCIuL2d1bnMvQXNzYXVsdFJpZmxlXCIpO1xudmFyIGl0ZW1UZXh0dXJlID0gXCJkYXRhOmltYWdlL3BuZztiYXNlNjQsaVZCT1J3MEtHZ29BQUFBTlNVaEVVZ0FBQUNBQUFBQWdDQVlBQUFCemVucjBBQUFBQVhOU1IwSUFyczRjNlFBQUFBUm5RVTFCQUFDeGp3djhZUVVBQUFBSmNFaFpjd0FBRHNNQUFBN0RBY2R2cUdRQUFBRHlTVVJCVkZoSDdaUXhEb013REVWTnI0RzZWbUpDNm1rNEl0ZGg3VnB4anNCUERhS1ZDTFp4eXBJbkljY2c1enMvQ1ZRb0tBajh1SExqZUVUb3VvNkh2bFFjVTN5SjkzMlBJS2tUY2VSQUZIOE5BNmRFM0l6YlZvZ2RRQk9QdHVWWGZrNUlKOGpXaEtZNFN4UGFRdmNtTEVXdVRVai9BMXNxaUVFY1RRQkVORFdqdmgzbXZadHhjY0xpd01xdkUwRHJoTlVCQ0N5MUtTZEFVc1Bpd0ZZY3BNNUVOcllXaDN0ZEk0Y1Q0ZGswTVNLUFh6TVNSU0MrUE1pMTRtY080ZTdlc3YyaUpxeUhFR0RWUENSNmp5TUM1bHVFUlhPZnVvWTdRRmk4TUtzRGU2dFhrOE9CdjdHZS9FOTZEWmVLRndvT0VFMXdVWDdURmg1enNnQUFBQUJKUlU1RXJrSmdnZz09XCI7XG5Nb2RBUEkubWV0YS50aXRsZShcIkRvbnV0J3MgR3VuIE1vZFwiKTtcbk1vZEFQSS5tZXRhLnZlcnNpb24oXCJ3SVBcIik7XG5Nb2RBUEkubWV0YS5pY29uKGl0ZW1UZXh0dXJlKTtcbk1vZEFQSS5tZXRhLmRlc2NyaXB0aW9uKFwiUmVxdWlyZXMgQXN5bmNTaW5rLiBTbyBmYXIganVzdCBza2lkZGVkIGNvZGUgZnJvbSByYWRtYW5cIik7XG5Nb2RBUEkuZGVkaWNhdGVkU2VydmVyLmFwcGVuZENvZGUoUGlzdG9sXzEuZGVmYXVsdCk7XG5Nb2RBUEkuZGVkaWNhdGVkU2VydmVyLmFwcGVuZENvZGUoQXNzYXVsdFJpZmxlXzEuZGVmYXVsdCk7XG52YXIgcGlzdG9sX2l0ZW0gPSAoMCwgUGlzdG9sXzEuZGVmYXVsdCkoKTtcbnZhciBhcl9pdGVtID0gKDAsIEFzc2F1bHRSaWZsZV8xLmRlZmF1bHQpKCk7XG5Nb2RBUEkuYWRkRXZlbnRMaXN0ZW5lcihcImxpYjphc3luY3NpbmtcIiwgZnVuY3Rpb24gKCkgeyByZXR1cm4gX19hd2FpdGVyKHZvaWQgMCwgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgX2EsIF9iLCBfYztcbiAgICByZXR1cm4gX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9kKSB7XG4gICAgICAgIHN3aXRjaCAoX2QubGFiZWwpIHtcbiAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICBNb2RBUEkuYWRkRXZlbnRMaXN0ZW5lcihcImN1c3RvbTphc3luY3NpbmtfcmVsb2FkZWRcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBNb2RBUEkubWMucmVuZGVySXRlbS5yZWdpc3Rlckl0ZW0ocGlzdG9sX2l0ZW0sIE1vZEFQSS51dGlsLnN0cihcInBpc3RvbFwiKSk7XG4gICAgICAgICAgICAgICAgICAgIE1vZEFQSS5tYy5yZW5kZXJJdGVtLnJlZ2lzdGVySXRlbShhcl9pdGVtLCBNb2RBUEkudXRpbC5zdHIoXCJhc3NhdWx0cmlmbGVcIikpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIEFzeW5jU2luay5MMTBOLnNldChcIml0ZW0ucGlzdG9sLm5hbWVcIiwgXCJQaXN0b2xcIik7XG4gICAgICAgICAgICAgICAgQXN5bmNTaW5rLkwxME4uc2V0KFwiaXRlbS5hc3NhdWx0cmlmbGUubmFtZVwiLCBcIkFzc2F1bHQgUmlmbGVcIik7XG4gICAgICAgICAgICAgICAgQXN5bmNTaW5rLnNldEZpbGUoXCJyZXNvdXJjZXBhY2tzL0FzeW5jU2lua0xpYi9hc3NldHMvbWluZWNyYWZ0L21vZGVscy9pdGVtL3Bpc3RvbC5qc29uXCIsIEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICAgICAgICAgICAgXCJwYXJlbnRcIjogXCJidWlsdGluL2dlbmVyYXRlZFwiLFxuICAgICAgICAgICAgICAgICAgICBcInRleHR1cmVzXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwibGF5ZXIwXCI6IFwiaXRlbXMvcGlzdG9sXCJcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgXCJkaXNwbGF5XCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwidGhpcmRwZXJzb25cIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwicm90YXRpb25cIjogWzUsIDgwLCAtNDVdLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwidHJhbnNsYXRpb25cIjogWzAsIDEsIC0zXSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInNjYWxlXCI6IFsxLjAsIDEuMCwgMS4wXVxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiZmlyc3RwZXJzb25cIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwicm90YXRpb25cIjogWzAsIC0xMzUsIDI1XSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInRyYW5zbGF0aW9uXCI6IFswLCA0LCAyXSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInNjYWxlXCI6IFsxLjgsIDEuOCwgMS44XVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgICAgIF9iID0gKF9hID0gQXN5bmNTaW5rKS5zZXRGaWxlO1xuICAgICAgICAgICAgICAgIF9jID0gW1wicmVzb3VyY2VwYWNrcy9Bc3luY1NpbmtMaWIvYXNzZXRzL21pbmVjcmFmdC90ZXh0dXJlcy9pdGVtcy9waXN0b2wucG5nXCJdO1xuICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIGZldGNoKGl0ZW1UZXh0dXJlKV07XG4gICAgICAgICAgICBjYXNlIDE6IHJldHVybiBbNCAvKnlpZWxkKi8sIChfZC5zZW50KCkpLmFycmF5QnVmZmVyKCldO1xuICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgIF9iLmFwcGx5KF9hLCBfYy5jb25jYXQoW19kLnNlbnQoKV0pKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XG4gICAgICAgIH1cbiAgICB9KTtcbn0pOyB9KTtcbiIsIi8vIFRoZSBtb2R1bGUgY2FjaGVcbnZhciBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX18gPSB7fTtcblxuLy8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbmZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG5cdHZhciBjYWNoZWRNb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdO1xuXHRpZiAoY2FjaGVkTW9kdWxlICE9PSB1bmRlZmluZWQpIHtcblx0XHRyZXR1cm4gY2FjaGVkTW9kdWxlLmV4cG9ydHM7XG5cdH1cblx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcblx0dmFyIG1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF0gPSB7XG5cdFx0Ly8gbm8gbW9kdWxlLmlkIG5lZWRlZFxuXHRcdC8vIG5vIG1vZHVsZS5sb2FkZWQgbmVlZGVkXG5cdFx0ZXhwb3J0czoge31cblx0fTtcblxuXHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cblx0X193ZWJwYWNrX21vZHVsZXNfX1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cblx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcblx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xufVxuXG4iLCIvLyBzdGFydHVwXG4vLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbi8vIFRoaXMgZW50cnkgbW9kdWxlIGlzIHJlZmVyZW5jZWQgYnkgb3RoZXIgbW9kdWxlcyBzbyBpdCBjYW4ndCBiZSBpbmxpbmVkXG52YXIgX193ZWJwYWNrX2V4cG9ydHNfXyA9IF9fd2VicGFja19yZXF1aXJlX18oXCIuL3NyYy9tYWluLnRzXCIpO1xuIl0sIm5hbWVzIjpbIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZXhwb3J0cyIsInZhbHVlIiwicmVjb2lsU3BlZWQiLCJEYW1hZ2VTb3VyY2VDbGFzcyIsIk1vZEFQSSIsInJlZmxlY3QiLCJnZXRDbGFzc0J5TmFtZSIsImNyZWF0aXZlTWlzY1RhYiIsImdldENsYXNzQnlJZCIsInN0YXRpY1ZhcmlhYmxlcyIsInRhYk1pc2MiLCJpdGVtQ2xhc3MiLCJpdGVtU3VwZXIiLCJnZXRTdXBlciIsIngiLCJsZW5ndGgiLCJubWlfQXNzYXVsdFJpZmxlIiwidGhpcyIsIiRzZXRDcmVhdGl2ZVRhYiIsImFkZEV2ZW50TGlzdGVuZXIiLCJwbGF5ZXIiLCJyb3RhdGlvblBpdGNoIiwicHJvdG90eXBlU3RhY2siLCJoYXNTaG90IiwiaW50ZXJuYWxfcmVnIiwiYXJfaXRlbSIsIiRzZXRVbmxvY2FsaXplZE5hbWUiLCJ1dGlsIiwic3RyIiwiJHNldE1heFN0YWNrU2l6ZSIsInN0YXRpY01ldGhvZHMiLCJyZWdpc3Rlckl0ZW0iLCJtZXRob2QiLCJrZXlnZW4iLCJpdGVtIiwiaXRlbXMiLCJwcm90b3R5cGUiLCIkb25QbGF5ZXJTdG9wcGVkVXNpbmciLCIkaXRlbXN0YWNrIiwiJG9uSXRlbVVzZUZpbmlzaCIsIiRnZXRNYXhJdGVtVXNlRHVyYXRpb24iLCIkZ2V0SXRlbVVzZUFjdGlvbiIsIkRSSU5LIiwiJG9uSXRlbVJpZ2h0Q2xpY2siLCIkd29ybGQiLCIkcGxheWVyIiwiY2FjdHVzIiwid29ybGQiLCJ3cmFwIiwiZW50aXR5cGxheWVyIiwic2hvdGVudGl0eWRhdGEiLCJleWVQb3NpdGlvbiIsImdldFBvc2l0aW9uRXllcyIsInRhcmdldFBvc2l0aW9uIiwicmF5VHJhY2UiLCJoaXRWZWMiLCJlbnRpdGllcyIsImdldEVudGl0aWVzV2l0aGluQUFCQkV4Y2x1ZGluZ0VudGl0eSIsImdldFJlZiIsImdldEVudGl0eUJvdW5kaW5nQm94IiwiZXhwYW5kIiwiZ2V0Q29ycmVjdGl2ZSIsImFycmF5IiwiY2xvc2VzdEVudGl0eSIsImlzSGVhZHNob3QiLCJpc0hlYWRzaG90SW50IiwiY2xvc2VzdERpc3RhbmNlIiwiaSIsImVudGl0eSIsImludGVyY2VwdCIsImNhbGN1bGF0ZUludGVyY2VwdCIsImRpc3RhbmNlIiwiZGlzdGFuY2VUbyIsImhlYWRzaG90IiwiaW50aGVhZHNob3QiLCJlbnRpdHlSYXlDYXN0Iiwic2V0SXRlbUluVXNlIiwiaXNSZW1vdGUiLCJhdHRhY2tFbnRpdHlGcm9tIiwiY29uc29sZSIsImxvZyIsInBsYXlTb3VuZEF0RW50aXR5Iiwibm1pX0l0ZW1QaXN0b2wiLCJwaXN0b2xfaXRlbSIsIl9fYXdhaXRlciIsInRoaXNBcmciLCJfYXJndW1lbnRzIiwiUCIsImdlbmVyYXRvciIsIlByb21pc2UiLCJyZXNvbHZlIiwicmVqZWN0IiwiZnVsZmlsbGVkIiwic3RlcCIsIm5leHQiLCJlIiwicmVqZWN0ZWQiLCJyZXN1bHQiLCJkb25lIiwidGhlbiIsImFwcGx5IiwiX19nZW5lcmF0b3IiLCJib2R5IiwiZiIsInkiLCJ0IiwiXyIsImxhYmVsIiwic2VudCIsInRyeXMiLCJvcHMiLCJnIiwiY3JlYXRlIiwiSXRlcmF0b3IiLCJ2ZXJiIiwiU3ltYm9sIiwiaXRlcmF0b3IiLCJuIiwidiIsIm9wIiwiVHlwZUVycm9yIiwiY2FsbCIsInBvcCIsInB1c2giLCJQaXN0b2xfMSIsIkFzc2F1bHRSaWZsZV8xIiwiaXRlbVRleHR1cmUiLCJtZXRhIiwidGl0bGUiLCJ2ZXJzaW9uIiwiaWNvbiIsImRlc2NyaXB0aW9uIiwiZGVkaWNhdGVkU2VydmVyIiwiYXBwZW5kQ29kZSIsImRlZmF1bHQiLCJfYSIsIl9iIiwiX2MiLCJfZCIsIm1jIiwicmVuZGVySXRlbSIsIkFzeW5jU2luayIsIkwxME4iLCJzZXQiLCJzZXRGaWxlIiwiSlNPTiIsInN0cmluZ2lmeSIsImZldGNoIiwiYXJyYXlCdWZmZXIiLCJjb25jYXQiLCJfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX18iLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJjYWNoZWRNb2R1bGUiLCJ1bmRlZmluZWQiLCJtb2R1bGUiLCJfX3dlYnBhY2tfbW9kdWxlc19fIl0sInNvdXJjZVJvb3QiOiIifQ==